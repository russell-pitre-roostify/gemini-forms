personal_information:
  group: "Borrower"
  partial: 'generic'
  step_name: "Personal Info Dude"
  step_identifier: :personal_information
  sub_steps:
    - form:
        components:
          - type: 'analytics'
            value: "page_name:pws/application/mortgage/borrower/personal-information,page_url:/application/mortgage/borrower/personal-information/,funnel_step:borrower,funnel_step_name:personal information,event_category:nil,event_action:nil,event_content:nil,funnel_name:mortgage application revised urla"
          - type: 'page_title'
            text: 'Welcome! Tell us a little about yourself'
          - type: 'section'
            resource: :primary_applicant
            legend: 'Personal Information'
            heading_level: 'h2'
            subtext: "All of your information, including your contact information is securely stored, and won't be shared with a third party."
            hint: "To help us verify your information, please use the same name you use for your taxes."

            conditions:
              - 'show_undisclosed_finances'
            components:

              # use css_classes on columned_fields to set total width and control individual inputs by css_classes or input_size(if you only want to shorten the input)
              - type: 'columned_fields'
                fields:
                  - field: :first_name
                    label: 'First name'
                    required: true
                    error_message: 'First name was left blank'
                    css_classes: 'col-7 col-md-4 js-restrict-emoji js-name-validation'
                  - field: :middle_initial
                    label: 'Middle initial'
                    input_size: 1
                    validation:
                      method: validate_multi_loan_applications
                      message: "This borrower name and email combination is being used on a loan that is already in the pipeline, and this account does not allow more than one loan per borrower. If you think this name/email combo is in error, you can change it in the Personal Information section. You can also enable multiple loans per borrower in the admin console."

              - type: 'section'
                options:
                  selector: 'row'
                components:
                  - type: 'text_field'
                    field: :last_name
                    label: 'Last name'
                    required: true
                    error_message: 'Last name was left blank'
                    selector: 'col-7 col-md-4 pr-0 mr-3 js-restrict-emoji js-name-validation'
                    wrapper_grid: 'col-12 col-md-12'

                  - type: "select"
                    field: :suffix
                    label: 'Suffix'
                    options: User::SUFFIX_VALUES
                    selector: 'col-3 col-md-2'

              - type: 'checkbox'
                field: :uses_alternate_name
                label: 'I have an alternate name'
                visibility_toggles:
                  selectors:
                    - "js-alternate_name_fields"
                  map:
                    - value: 'true'
                      show:
                        - "js-alternate_name_fields"

              - type: 'columned_fields'
                selector: 'js-alternate_name_fields'
                fields:
                  - field: :alternate_first_name
                    label: 'First name'
                    css_classes: 'col-7 col-md-4'
                  - field: :alternate_middle_initial
                    label: 'Middle initial'
                    input_size: 1

              - type: 'section'
                options:
                  selector: 'row js-alternate_name_fields'
                components:
                  - type: 'text_field'
                    field: :alternate_last_name
                    label: 'Last name'
                    selector: 'col-7 col-md-4 pr-0 mr-3'
                    wrapper_grid: 'col-12 col-md-12'

                  - type: "select"
                    field: :alternate_suffix
                    label: 'Suffix'
                    options: User::SUFFIX_VALUES
                    selector: 'col-3 col-md-2'

              - type: "email_field"
                field: :email
                label: "Email address"
                input_size: 9
                required: true
                error_message: 'Email address was left blank'
              - type: "phone_field"
                field: :home_phone
                label: "Home phone"
                css_classes: "input-phone-no-ext js-input-phone"
                input_type: "tel"
              - type: "phone_field"
                field: :cell_phone
                label: "Cell phone"
                css_classes: 'input-phone-no-ext js-input-phone'
                input_type: "tel"
              - type: "phone_field"
                field: :phone
                label: "Work phone"
                css_classes: "input-phone js-input-phone"
                input_type: "tel"
              - type: 'select'
                field: :preferred_phone
                label: 'Preferred phone during business hours'
                css_classes: 'js-preferred-phone'
                include_blank: 'Please select one'
                options:
                  'Cell Phone' : 1
                  'Home Phone' : 2
                  'Work Phone' : 3
                input_size: 3

          - type: 'section'
            resource: 'loan_application'
            legend: 'Personal Information'
            legend_sr_only: 'true'
            heading_level: 'h2'
            components:
              - type: 'section'
                legend: :lead_source_question
                components:
                  - type: "select"
                    field: :lead_source
                    options: :account_lead_sources
                    include_blank: 'Please select one'
                    input_size: 3
                    selector: 'js-lead_source'
                    visibility_toggles:
                      selectors:
                        - "js-lead_source_other_selected"
                      map:
                        - value: "Other"
                          show:
                            - "js-lead_source_other_selected"

                  - type: "text_field"
                    selector: 'js-lead_source_other_selected'
                    field: :lead_source_val
                    label: "Please Specify"

              - type: "component_header"
                text: :relationship_question
                id: 'relationship_question_1612333731275'

          - type: 'section'
            resource: :primary_applicant
            components:
              - type: "checkbox"
                field: :account_relationship
                label: "I have an account here"
              - type: "checkbox"
                field: :employee_relationship
                label: "I am an employee"

              - type: 'section_title'
                text: 'Addresses'
              - type: 'section'
                resource: :current_address
                components:
                  - type: 'section'
                    legend: 'Where do you currently live?'
                    hint: "This information helps us verify your credit."
                    components:
                      - type: 'address_one_field'
                        label: 'Street Address'
                        field: :address1
                        input_size: 9
                      - type: 'text_field'
                        label: 'Apt/Unit/Suite (if applicable)'
                        field: :address2
                        input_size: 9
                        max_length: 10
                      - type: 'text_field'
                        field: :city
                        label: 'City'
                        input_size: 9
                      - type: "select"
                        options: :state_options
                        field: :state
                        label: 'State'
                        input_size: 3
                        include_blank: 'Please select one'
                        css_classes: 'js-recurring-state-with-county'
                      - type: 'zip_field'
                        field: :zip
                        label: 'Zip'
                        input_size: 3
                      - type: 'select'
                        field: :county_fips
                        label: 'County'
                        options: county_options
                        input_size: 5
                        input_classes: 'js-counties'
                        disabled: 'state_not_present?'
                        css_classes: 'col-md-6'
                      - type: 'select'
                        field: :country
                        options: country_options
                        input_size: 5
                        input_classes: 'js-countries'
                        label: 'Country'
                      - type: 'date_input'
                        field: :start_date
                        label: "Start Date"
                        day_css: 'col-md-2 col-4'
                        month_css: 'col-md-2 col-4'
                        year_css: 'col-md-2 col-4'
                        css_classes: "js-current-address"
                        selector: 'js-start_date'
                        visibility_toggles:
                          selectors:
                            - 'js-previous-address'
                          map:
                            - value:
                                time: 63072000
                              show:
                                - 'js-previous-address'
                        recurse:
                          date_difference: 63072000

              - type: 'section'
                legend: 'Do you own or rent where you live?'
                components:
                  - type: 'checkbox'
                    field: :no_primary_housing_expenses
                    label: 'I have no primary housing expense'
                    visibility_toggles:
                      selectors:
                        - 'js-own-or-rent'
                      map:
                        - value: 'false'
                          show:
                            - 'js-own-or-rent'
                  - type: 'section'
                    resource: :current_address
                    options:
                      selector: 'js-own-or-rent'
                    components:
                      - type: 'button_group'
                        field: :own
                        choices:
                          'Own': true
                          'Rent': false
                        visibility_toggles:
                          selectors:
                            - 'js-monthly-rent'
                          map:
                            - value: 'false'
                              show:
                                - 'js-monthly-rent'
                      - type: 'currency'
                        field: :monthly_rent
                        label: 'Monthly rent'
                        selector: 'js-monthly-rent'
                        input_size: 5

          - type: 'section'
            resource: :primary_applicant
            options:
              selector: 'js-previous-address'
            components:
              - type: 'recurring_section'
                resource: :previous_addresses
                add_btn_label: 'Add another address'
                display_trash: true
                hide_first_seperator: true
                options:
                  fieldset_legend: 'Previous address'
                components:
                  - type: "section_title"
                    text: 'What was your previous address?'
                  - type: 'address_one_field'
                    label: 'Street Address'
                    field: :address1
                    input_size: 9
                  - type: 'text_field'
                    label: 'Apt/Unit/Suite (if applicable)'
                    field: :address2
                    input_size: 9
                    max_length: 10
                  - type: 'text_field'
                    field: :city
                    label: 'City'
                    input_size: 9
                  - type: "select"
                    options: :state_options
                    field: :state
                    label: 'State'
                    input_size: 3
                    include_blank: 'Please select one'
                    css_classes: 'js-recurring-state-with-county'
                  - type: 'zip_field'
                    field: :zip
                    label: 'Zip'
                    input_size: 3
                  - type: 'select'
                    field: :county_fips
                    label: 'County'
                    options: county_options
                    input_size: 5
                    input_classes: 'js-counties'
                    disabled: 'state_not_present?'
                    css_classes: 'col-md-6'
                  - type: 'select'
                    field: :country
                    options: country_options
                    input_size: 5
                    input_classes: 'js-countries'
                    label: 'Country'
                  - type: 'section' #previous address start_date wasn't receiveing correct class before this
                    css_classes: "js-start_date js-previous-address-start-date"
                    components:
                      - type: 'date_input'
                        field: :start_date
                        label: "Start Date"
                        day_css: 'col-md-2 col-4'
                        month_css: 'col-md-2 col-4'
                        year_css: 'col-md-2 col-4'
                        css_classes: "js-add_another_date"
                        recurse:
                          date_difference: 63072000
                  - type: 'button_group'
                    legend: 'Do you currently own this property?'
                    field: :own
                    visibility_toggles:
                      selectors:
                        - 'js-previous-monthly-rent'
                      map:
                        - value: 'false'
                          show:
                            - 'js-previous-monthly-rent'
                  - type: 'currency'
                    field: :monthly_rent
                    label: 'Monthly rent'
                    selector: 'js-previous-monthly-rent'
                    input_size: 5

          - type: 'section'
            resource: :primary_applicant
            legend: 'Do you have a separate mailing address?'
            hint: "We need this information to process your application."
            components:
              - type: 'button_group'
                field: :separate_mailing_address
                visibility_toggles:
                  selectors:
                    - 'js-mailing_address'
                  map:
                    - value: 'true'
                      show:
                        - 'js-mailing_address'
              - type: 'section'
                resource: :urla_mailing_address
                options:
                  selector: 'js-mailing_address'
                components:
                  - type: 'address_one_field'
                    label: 'Address'
                    field: :address1
                    input_size: 9
                  - type: 'text_field'
                    label: 'Apt/Unit/Suite (if applicable)'
                    field: :address2
                    input_size: 9
                    max_length: 10
                  - type: 'text_field'
                    field: :city
                    label: 'City'
                    input_size: 9
                  - type: "select"
                    options: :state_options
                    field: :state
                    label: 'State'
                    input_size: 3
                    include_blank: 'Please select one'
                    css_classes: 'js-recurring-state-with-county'
                  - type: 'zip_field'
                    field: :zip
                    label: 'Zip'
                    input_size: 3
                  - type: 'select'
                    field: :county_fips
                    label: 'County'
                    options: county_options
                    input_size: 5
                    input_classes: 'js-counties'
                    disabled: 'state_not_present?'
                    css_classes: 'col-md-6'
                  - type: 'select'
                    field: :country
                    options: country_options
                    input_size: 5
                    input_classes: 'js-countries'
                    label: 'Country'


          - type: 'section'
            resource: :primary_applicant
            legend: 'Life events'
            heading_level: 'h2'
            components:
              - type: 'date_input'
                field: :dob
                label: "Date of Birth"
                day_css: 'col-md-2 col-4'
                month_css: 'col-md-2 col-4'
                year_css: 'col-md-2 col-4'
                date_input_validation_type: 'js-date-of-birth'
                #min_year_limit: 120
                #max_year_limit: 0
              - type: "select"
                label: 'Education level'
                field: :years_schooling
                options: SCHOOLING_OPTIONS
                include_blank: 'Please select one'
                input_size: 3
              - type: 'button_group'
                legend: 'Marital Status'
                hint: "For this application, we need to use the government's definitions for marital status:
                    * If you are single, divorced, or widowed, or are currently in a civil union, domestic partnership or registered reciprocal beneficiary relationship, choose 'Unmarried'.
                    * If you are married, choose 'Married'.
                    * If you are legally married but live separately from your spouse, with separate finances, choose 'Separated'."
                field: :marital_status
                css_classes: 'js-marital-status'
                choices:
                  Married: 2
                  Separated: 3
                  Unmarried: 1
                checkboxes_toggles:
                  values:
                    - value: '2'
                      toggles:
                        - selectors:
                          - value: 'true'
                            selector:
                              - 'js-coborrower-toggle'
                          map:
                            - value: true
                              show: true
                              attribute: 'checked'
                              selector:
                                - 'js-has_spouse'
                            - value: true
                              show: true
                              attribute: 'checked'
                              selector:
                                - 'js-coborrower_joint'
                    - value: '1'
                      toggles:
                        - selectors:
                          - value: 'true'
                            selector:
                              - 'js-coborrower-toggle'
                          map:
                            - value: false
                              attribute: 'checked'
                              hide: true
                              selector:
                                - 'js-has_spouse'
                            - show: true
                              selector:
                                - 'js-coborrower_joint'
                    - value: '3'
                      toggles:
                        - selectors:
                          - value: 'true'
                            selector:
                              - 'js-coborrower-toggle'
                          map:
                            - value: false
                              attribute: 'checked'
                              hide: true
                              selector:
                                - 'js-has_spouse'
                            - show: true
                              selector:
                                - 'js-coborrower_joint'
                visibility_toggles:
                  selectors:
                    - 'js-legal_spouse'
                  map:
                    - value: 1
                      show:
                        - 'js-legal_spouse'
              - type: 'section'
                options:
                  selector: 'js-legal_spouse'
                components:
                  - type: 'button_group'
                    field: :legal_spouse
                    legend: 'Is there a person who is not your legal spouse but who currently has real property rights similar to those of a legal spouse?'
                    hint: 'This helps us understand the risk profile of this loan.'
                    visibility_toggles:
                      selectors:
                        - 'js-relationship'
                      map:
                        - value: 'true'
                          show:
                            - 'js-relationship'
                  - type: 'section'
                    options:
                      selector: 'js-relationship'
                    components:
                      - type: 'section'
                        components:
                          - type: 'component_header'
                            text: 'Indicate the type of relationship and the state in which the relationship was formed.'
                            id: 'relationship_type_1610531780302'
                          - type: 'select'
                            field: :relationship_type
                            options: RELATIONSHIP_TYPE
                            label: 'Type of Relationship'
                            input_size: 5
                            include_blank: 'Please select one'
                            css_classes: 'js-relationship-type'
                            visibility_toggles:
                              selectors:
                                - 'js-relationship-type-others'
                              map:
                                - value: '4'
                                  show:
                                    - 'js-relationship-type-others'
                          - type: 'text_field'
                            label: 'Other Type'
                            field: :relationship_type_other
                            selector: 'js-relationship-type-others'
                            css_classes: 'col-10 col-sm-6 col-md-7'
                          - type: "select"
                            field: :relationship_state
                            options: :states
                            label: "State of Partnership"
                            input_size: 3
                            include_blank: 'Please select one'
                            css_classes: 'js-relationship-state'

              - type: 'button_group'
                legend: 'Do you have any dependents?'
                field: has_dependents
                visibility_toggles:
                  selectors:
                    - 'js-dependents'
                  map:
                    - value: 'true'
                      show:
                        - 'js-dependents'
              - type: 'section'
                legend: 'Age of dependents'
                subtext: "List the age of each of your dependents separated by commas. If your dependent is less than one year of age, put “1”. For example, let's say you have three dependents: Aged 3 months, 5 years, and 7 years. You would enter ”1, 5, 7”."
                selector: 'js-dependents'
                components:
                  - type: 'text_field'
                    field: dependents
                    css_classes: 'col-8 input-age-int'
              - type: 'radio_button_collection'
                field: :citizenship
                legend: 'What is your citizenship status?'
                hint: 'This helps us understand the risk profile of this loan.'
                options: CITIZENSHIP_STATUS
              - type: 'button_group'
                field: :military_service
                legend: 'Did you (or your deceased spouse) ever serve, or are you currently serving, in the United States Armed Forces?'
                hint: 'Military veterans and active military members can qualify for special programs like Veterans Affairs mortgages. The VA mortgage program was established by the United States Department of Veteran Affairs to help veterans and their families obtain home financing. You will be asked to provide your DD-214 and Certificate of Eligibility.'
                visibility_toggles:
                  selectors:
                    - 'js-military_status'
                    - 'js-military_status-others'
                    - 'js-dischared-fields'
                    - 'js-actively-serving-fields'
                  map:
                    - value: 'true'
                      show:
                        - 'js-military_status'
                        - 'js-military_status-others'
                checkboxes_toggles:
                  values:
                    - value: 'false'
                      toggles:
                        - selectors:
                          map:
                            - value: false
                              attribute: 'checked'
                              selector:
                                - 'js-military_status'
                            - value: false
                              attribute: 'checked'
                              selector:
                                - 'js-military_status-others'

              - type: 'checkbox_collection'
                legend: 'Military status'
                field: :military_status
                options: MILITARY_STATUS
                selector: 'js-military_status'
                visibility_toggles:
                  selectors:
                    - 'js-dischared-fields'
                    - 'js-actively-serving-fields'
                  map:
                    - value: 1
                      show:
                        - 'js-actively-serving-fields'
                    - value: 2
                      show:
                        - 'js-dischared-fields'
              - type: 'checkbox'
                field: :military_non_active
                selector: 'mt-3 js-military_status-others'
                label: 'Only period of service was as a non-activated member of the Reserve or National Guard.'

              - type: 'section'
                selector: 'js-actively-serving-fields'
                components:
                  - type: 'date_input'
                    label: 'Projected expiration date of service/tour'
                    field: :discharging_at
                    max_year_limit: 120
                    min_year_limit: 0
                    validation:
                      method: validate_discharging_at_date
                      message: 'Active duty end date should be in the future'
                    day_css: 'col-md-2 col-4'
                    month_css: 'col-md-2 col-4'
                    year_css: 'col-md-2 col-4'
                    future_only: true
                  - type: 'select'
                    field: :military_branch
                    options: MILITARY_BRANCHES_INVERTED
                    label: 'In what branch of the military do you serve?'
                    include_blank: true
                  - type: 'select'
                    field: :military_type
                    options: MILITARY_TYPES_INVERTED
                    label: 'In what capacity do you serve?'
                    include_blank: true
                  - type: 'button_group'
                    field: :first_va_loan
                    label: 'Is this your first home loan with the VA Loan program?'
                  - type: 'radio_button_collection'
                    field: :va_funding_fee_exempt
                    options: VA_FUNDING_FEE_STATUSES
                    label: 'Are you exempt from the VA loan funding fee?'

              - type: 'section'
                selector: 'js-dischared-fields js-date-range'
                components:
                  - type: 'component_header'
                    text: 'My period of service was …'
                  - type: 'date_input'
                    label: 'Starting From'
                    field: :incharged_at
                    day_css: 'col-md-2 col-4'
                    month_css: 'col-md-2 col-4'
                    year_css: 'col-md-2 col-4'
                    selector: 'js-start-date-discharged'
                    validation:
                      method: validate_incharged_at_date
                      message: 'State date should be in the past'
                  - type: 'date_input'
                    label: 'Discharged'
                    field: :discharged_at
                    day_css: 'col-md-2 col-4'
                    month_css: 'col-md-2 col-4'
                    year_css: 'col-md-2 col-4'
                    validation:
                      method: validate_discharged_at_date
                      message: 'Discharged date should be in the past'
                    selector: 'js-end-date-discharged'
                    error_message: 'Discharged date must be later than start date and must not be in the future'
                  - type: 'button_group'
                    label: 'Do you have a report of separation (e.g., DD-214 Form)?'
                    field: :va_ros
                  - type: 'button_group'
                    label: 'Do you have a Certificate of Eligibility to certify that you qualify for a VA-backed loan?'
                    field: :va_coe

          - type: 'section'
            resource: 'loan_application'
            legend: 'Co-borrower'
            conditions:
              - 'not multi_borrower_enabled'
            heading_level: 'h2'
            components:
              - type: "modal"
                partial: 'loan_applications/fields/remove_applicant_modal'
              - type: "button_group"
                legend: "Are you applying for this loan with anyone else?"
                field: :has_coborrower
                css_classes: 'js-coborrower-toggle'
                exclusive: true
                checkboxes_toggles:
                  values:
                    - value: 'true'
                      toggles:
                        - selectors:
                          - value: '2'
                            selector:
                              - 'js-marital-status'
                          map:
                            - value: true
                              show: true
                              attribute: 'checked'
                              selector:
                                - 'js-has_spouse'
                            - value: true
                              show: true
                              attribute: 'checked'
                              selector:
                                - 'js-coborrower_joint'
                        - selectors:
                          - value: '1'
                            selector:
                              - 'js-marital-status'
                          map:
                            - value: false
                              attribute: 'checked'
                              hide: true
                              selector:
                                - 'js-has_spouse'
                        - selectors:
                          - value: '3'
                            selector:
                              - 'js-marital-status'
                          map:
                            - value: false
                              attribute: 'checked'
                              hide: true
                              selector:
                                - 'js-has_spouse'
                visibility_toggles:
                  selectors:
                    - 'js-coborrower_section'
                    - 'js-coborrower_lived_with_borrower'
                    - 'js-coborrower_address_section'
                  map:
                    - value: 'true'
                      show:
                        - 'js-coborrower_section'
                        - 'js-coborrower_lived_with_borrower'
                        - 'js-coborrower_address_section'

          - type: 'section'
            conditions:
              - 'not multi_borrower_enabled'
            resource: :coapplicants
            legend: 'Add a co-borrower'
            subtext: 'By adding co-borrowers, you confirm that you have their express permission to apply on their behalf. A co-borrower is a person other than you whose income, assets, liabilities, and credit history is considered to determine creditworthiness for a home loan.'
            hint: 'The name, email, and phone of your co-borrowers will be used across the application. Use legal names for the fastest process.'
            options:
              selector: 'js-coborrower_section'
            components:
              - type: 'columned_fields'
                fields:
                  - field: :first_name
                    label: 'First name'
                    css_classes: 'col-7 col-md-4 js-restrict-emoji js-name-validation'
                    only_mark_as_required: true
                  - field: :middle_initial
                    label: 'Middle initial'
                    input_size: 1

              - type: 'section'
                options:
                  selector: 'row'
                components:
                  - type: 'text_field'
                    field: :last_name
                    label: 'Last name'
                    only_mark_as_required: true
                    selector: 'col-7 col-md-4 pr-0 mr-3 js-restrict-emoji js-name-validation'
                    wrapper_grid: 'col-12 col-md-12'

                  - type: "select"
                    field: :suffix
                    label: 'Suffix'
                    options: User::SUFFIX_VALUES
                    selector: 'col-3 col-md-2'

              - type: 'checkbox'
                field: :uses_alternate_name
                label: 'Co-borrower has an alternate name'
                visibility_toggles:
                  selectors:
                    - "js-coborrower_alternate_name_fields"
                  map:
                    - value: 'true'
                      show:
                        - "js-coborrower_alternate_name_fields"

              - type: 'columned_fields'
                selector: 'js-coborrower_alternate_name_fields'
                fields:
                  - field: :alternate_first_name
                    label: 'Alternate first name'
                    css_classes: 'col-7 col-md-4'
                  - field: :alternate_middle_initial
                    label: 'Middle initial'
                    input_size: 1

              - type: 'section'
                options:
                  selector: 'row js-coborrower_alternate_name_fields'
                components:
                  - type: 'text_field'
                    field: :alternate_last_name
                    label: 'Alternate last name'
                    selector: 'col-7 col-md-4 pr-0 mr-3'
                    wrapper_grid: 'col-12 col-md-12'

                  - type: "select"
                    field: :alternate_suffix
                    label: 'Suffix'
                    options: User::SUFFIX_VALUES
                    selector: 'col-3 col-md-2'

              - type: "email_field"
                field: :email
                label: "Email address"
                input_size: 9
                only_mark_as_required: true
                validation:
                  method: check_unique_name_and_email
                  message: 'The names and emails of the Borrower and Co-borrower match exactly, which will cause record-keeping issues. Please edit one or both names or emails to create unique users.'
              - type: "phone_field"
                field: :home_phone
                label: "Home phone"
                css_classes: 'input-phone-no-ext js-input-phone'
              - type: "phone_field"
                field: :cell_phone
                label: "Cell phone"
                css_classes: 'input-phone-no-ext js-input-phone'
              - type: "phone_field"
                field: :phone
                label: "Work phone"
                css_classes: "input-phone js-input-phone"
              - type: 'select'
                field: :preferred_phone
                label: 'Preferred phone during business hours'
                css_classes: 'js-preferred-phone'
                include_blank: 'Please select one'
                options:
                  'Cell Phone' : 1
                  'Home Phone' : 2
                  'Work Phone' : 3
                input_size: 3
              - type: 'checkbox'
                field: :has_spouse
                label: 'This co-borrower is my spouse'
                css_classes: 'js-has_spouse'
                hint: "if your spouse is your co-borrower, we'll assume that you are jointly reporting your assets and liabilities. If your co-borrower is another family member or a business partner, assets and liabilities will be reported separately."
                checkboxes_toggles:
                  values:
                    - value: true
                      toggles:
                        - selectors:
                          - value: '2'
                            selector:
                              - 'js-marital-status'
                          map:
                            - value: true
                              attribute: 'checked'
                              hide: true
                              selector:
                                - 'js-coborrower_joint'
                    - value: false
                      toggles:
                        - selectors:
                          - value: '2'
                            selector:
                              - 'js-marital-status'
                          map:
                            - show: true
                              selector:
                                - 'js-coborrower_joint'
              - type: 'checkbox'
                field: :has_joint_applicant
                label: 'I am applying jointly with this co-borrower'
                hint: 'A joint application is a combined form done by two or more people, who usually share assets and liabilities. This is most often used if two people on the loan are married. If you apply with a co-borrower but do not apply jointly, your loan application will look slightly different.'
                css_classes: 'js-coborrower_joint'
              - type: 'section'
                css_classes: js-coborrower_address_section
                options:
                  selector: 'js-coborrower_lived_with_borrower'
                components:
                  - type:  'button_group'
                    legend: 'Has this borrower lived with you for the past 2 years?'
                    field: :coborrower_lived_with_borrower
                    choices:
                      'Yes': true
                      'No': false
                    css_classes: 'js-coborrower_lived_with_borrower'
                    visibility_toggles:
                      selectors:
                        - 'js-coborrower_address'
                      map:
                        - value: 'false'
                          show:
                            - 'js-coborrower_address'
                  - type: 'section'
                    resource: :current_address
                    options:
                      selector: 'js-coborrower_address'
                    components:
                      - type: "component_header"
                        text: 'Where does the co-borrower currently live?'
                        hint: "This information helps us verify their credit."
                        id: 'current_residence_1612225615936'
                      - type: 'address_one_field'
                        label: 'Street Address'
                        field: :address1
                        aria_labelledby: 'current_residence_1612225615936'
                        input_size: 9
                      - type: 'text_field'
                        label: 'Apt/Unit/Suite (if applicable)'
                        field: :address2
                        aria_labelledby: 'current_residence_1612225615936'
                        input_size: 9
                        max_length: 10
                      - type: 'text_field'
                        field: :city
                        label: 'City'
                        aria_labelledby: 'current_residence_1612225615936'
                        input_size: 9
                      - type: "select"
                        options: :state_options
                        field: :state
                        label: 'State'
                        aria_labelledby: 'current_residence_1612225615936'
                        input_size: 3
                        include_blank: 'Please select one'
                        css_classes: 'js-recurring-state-with-county'
                      - type: 'zip_field'
                        field: :zip
                        label: 'Zip'
                        aria_labelledby: 'current_residence_1612225615936'
                        input_size: 3
                      - type: 'select'
                        field: :country
                        selector: 'js-construction-address'
                        options: country_options
                        input_size: 5
                        input_classes: 'js-countries'
                        label: 'Country'
          - type: 'section'
            conditions:
              - 'multi_borrower_enabled'
            resource: 'loan_application'
            legend: 'Co-Borrowers'
            heading_level: 'h2'
            components:
              - type: "modal"
                partial: 'loan_applications/fields/remove_applicant_modal'
              - type: "radio_button_collection"
                legend: "Are you applying for this loan with anyone else?"
                css_classes: 'js-coborrowers_status'
                field: :coborrowers_status
                options: COBORROWER_TYPES
                visibility_toggles:
                  selectors:
                    - 'js-coborrower_with_spouse_header'
                    - 'js-coborrower_section_header'
                    - 'js-coborrower_section'
                    - 'js-coborrower_lived_with_borrower'
                    - 'js-additional_applicants'
                    - 'js-coborrower_joint_with_spouse'
                    - 'js-coborrower_joint_with_non_spouse'
                    - "js-secondary_applicant_has_spouse"
                  map:
                    - value: 2
                      show:
                        - 'js-coborrower_with_spouse_header'
                        - 'js-coborrower_section'
                        - 'js-coborrower_joint_with_spouse'
                        - 'js-coborrower_lived_with_borrower'
                    - value: 3
                      show:
                        - 'js-coborrower_with_spouse_header'
                        - 'js-coborrower_section'
                        - 'js-coborrower_lived_with_borrower'
                        - 'js-coborrower_joint_with_spouse'
                        - 'js-additional_applicants'
                    - value: 4
                      show:
                        - 'js-coborrower_section'
                        - 'js-coborrower_section_header'
                        - 'js-coborrower_lived_with_borrower'
                        - 'js-additional_applicants'
                        - 'js-coborrower_joint_with_non_spouse'
                        - "js-secondary_applicant_has_spouse"

          # coborrower section
          - type: 'section'
            conditions:
              - 'multi_borrower_enabled'
            resource: :primary_coapplicants
            legend: 'Add a co-borrower'
            heading_level: 'h2'
            subtext: 'By adding co-borrowers, you confirm that you have their express permission to apply on their behalf. A co-borrower is a person other than you whose income, assets, liabilities, and credit history is considered to determine creditworthiness for a home loan.'
            hint: 'The name, email, and phone of your co-borrowers will be used across the application. Use legal names for the fastest process.'
            options:
              selector: 'js-coborrower_section'
            components:
              - type: 'component_header'
                text: 'Co-borrower'
                selector: 'js-coborrower_section_header'
              - type: 'component_header'
                text: 'Co-borrower - your spouse'
                selector: 'js-coborrower_with_spouse_header'
              - type: 'section'
                components:
                  - type: 'columned_fields'
                    fields:
                      - field: :first_name
                        label: 'First name'
                        css_classes: 'col-7 col-md-4 js-restrict-emoji js-name-validation'
                        only_mark_as_required: true
                      - field: :middle_initial
                        label: 'Middle initial'
                        input_size: 1
                  - type: 'section'
                    options:
                      selector: 'row'
                    components:
                      - type: 'text_field'
                        field: :last_name
                        label: 'Last name'
                        only_mark_as_required: true
                        selector: 'col-7 col-md-4 pr-0 mr-3 js-restrict-emoji js-name-validation'
                        wrapper_grid: 'col-12 col-md-12'

                      - type: "select"
                        field: :suffix
                        label: 'Suffix'
                        options: User::SUFFIX_VALUES
                        selector: 'col-3 col-md-2'

                  - type: 'checkbox'
                    field: :uses_alternate_name
                    label: 'Coborrower has an alternate name'
                    visibility_toggles:
                      selectors:
                        - "js-coborrower_alternate_name_fields"
                      map:
                        - value: 'true'
                          show:
                            - "js-coborrower_alternate_name_fields"

                  - type: 'columned_fields'
                    selector: 'js-coborrower_alternate_name_fields'
                    fields:
                      - field: :alternate_first_name
                        label: 'Alternate first name'
                        css_classes: 'col-7 col-md-4'
                      - field: :alternate_middle_initial
                        label: 'Middle initial'
                        input_size: 1

                  - type: 'section'
                    options:
                      selector: 'row js-coborrower_alternate_name_fields'
                    components:
                      - type: 'text_field'
                        field: :alternate_last_name
                        label: 'Alternate last name'
                        selector: 'col-7 col-md-4 pr-0 mr-3'
                        wrapper_grid: 'col-12 col-md-12'

                      - type: "select"
                        field: :alternate_suffix
                        label: 'Suffix'
                        options: User::SUFFIX_VALUES
                        selector: 'col-3 col-md-2'

                  - type: "email_field"
                    field: :email
                    label: "Email address"
                    input_size: 9
                    only_mark_as_required: true
                    validation:
                      method: check_unique_name_and_email
                      message: 'The names and emails of the Borrower and Co-Borrower match exactly, which will cause record-keeping issues. Please edit one or both names or emails to create unique users.'
                  - type: "phone_field"
                    field: :home_phone
                    label: "Home phone"
                    css_classes: 'input-phone-no-ext js-input-phone'
                  - type: "phone_field"
                    field: :cell_phone
                    label: "Cell phone"
                    css_classes: 'input-phone-no-ext js-input-phone'
                  - type: "phone_field"
                    field: :phone
                    label: "Work phone"
                    css_classes: "input-phone js-input-phone"
                  - type: 'select'
                    field: :preferred_phone
                    label: 'Preferred phone during business hours'
                    css_classes: 'js-preferred-phone'
                    include_blank: 'Please select one'
                    options:
                      'Cell Phone' : 1
                      'Home Phone' : 2
                      'Work Phone' : 3
                    input_size: 3
                  - type: 'section'
                    css_classes: js-coborrower_address_section
                    options:
                      selector: 'js-coborrower_lived_with_borrower'
                    components:
                      - type:  'button_group'
                        legend: 'Has this borrower lived with you for the past 2 years?'
                        field: :coborrower_lived_with_borrower
                        choices:
                          'Yes': true
                          'No': false
                  - type:  'button_group'
                    legend: 'Are you applying jointly with this co-borrower?'
                    selector: 'js-coborrower_joint_with_non_spouse'
                    hint: 'A joint application is a combined form done by two or more people, who usually share assets and liabilities. This is most often used if two people on the loan are married. If you apply with a co-borrower but do not apply jointly, your loan application will look slightly different.'
                    field: :has_joint_applicant
                    choices:
                      'Yes': true
                      'No': false
                    css_classes: 'js-coborrower_joint'
                    visibility_toggles:
                      selectors:
                        - "js-secondary_applicant_has_spouse"
                      map:
                        - value: 'false'
                          show:
                            - "js-secondary_applicant_has_spouse"
                  - type: 'section'
                    selector: 'js-secondary_applicant_has_spouse'
                    components:
                      - type: 'button_group'
                        field: :has_non_primary_spouse
                        css_classes: 'js-has_non_primary_spouse'
                        label: 'Are they applying jointly with spouse?'
                        visibility_toggles:
                          selectors:
                            - "js-secondary_borrower_spouse"
                          map:
                            - value: 'true'
                              show:
                                - "js-secondary_borrower_spouse"
                      - type: 'section'
                        options:
                          selector: "js-secondary_borrower_spouse"
                        resource: :non_primary_spouse
                        css_classes: "js-secondary_borrower_spouse"
                        components:
                          - type: 'columned_fields'
                            fields:
                              - field: :first_name
                                label: 'First name'
                                css_classes: 'col-7 col-md-4 js-restrict-emoji js-secondary_spouse_fn js-name-validation'
                                only_mark_as_required: true
                              - field: :middle_initial
                                label: 'Middle initial'
                                input_size: 1

                          - type: 'section'
                            options:
                              selector: 'row'
                            components:
                              - type: 'text_field'
                                field: :last_name
                                label: 'Last name'
                                only_mark_as_required: true
                                selector: 'col-7 col-md-4 pr-0 mr-3 js-restrict-emoji js-secondary_spouse_ln js-name-validation'
                                wrapper_grid: 'col-12 col-md-12'

                              - type: "select"
                                field: :suffix
                                label: 'Suffix'
                                options: User::SUFFIX_VALUES
                                selector: 'col-3 col-md-2'

                          - type: 'checkbox'
                            field: :uses_alternate_name
                            label: 'Coborrower has an alternate name'
                            visibility_toggles:
                              selectors:
                                - "js-secondary_borrower_spouse_alternate_name_fields"
                              map:
                                - value: 'true'
                                  show:
                                    - "js-secondary_borrower_spouse_alternate_name_fields"

                          - type: 'columned_fields'
                            selector: 'js-secondary_borrower_spouse_alternate_name_fields'
                            fields:
                              - field: :alternate_first_name
                                label: 'Alternate first name'
                                css_classes: 'col-7 col-md-4'
                              - field: :alternate_middle_initial
                                label: 'Middle initial'
                                input_size: 1

                          - type: 'section'
                            options:
                              selector: 'row js-secondary_borrower_spouse_alternate_name_fields'
                            components:
                              - type: 'text_field'
                                field: :alternate_last_name
                                label: 'Alternate last name'
                                selector: 'col-7 col-md-4 pr-0 mr-3'
                                wrapper_grid: 'col-12 col-md-12'

                              - type: "select"
                                field: :alternate_suffix
                                label: 'Suffix'
                                options: User::SUFFIX_VALUES
                                selector: 'col-3 col-md-2'

                          - type: "email_field"
                            field: :email
                            label: "Email address"
                            css_classes: 'js-secondary_spouse_email'
                            input_size: 9
                            only_mark_as_required: true
                            validation:
                              method: check_unique_name_and_email
                              message: 'The names and emails of the Borrower and Co-Borrower match exactly, which will cause record-keeping issues. Please edit one or both names or emails to create unique users.'
                          - type: "phone_field"
                            field: :home_phone
                            label: "Home phone"
                            css_classes: 'input-phone-no-ext js-input-phone'
                          - type: "phone_field"
                            field: :cell_phone
                            label: "Cell phone"
                            css_classes: 'input-phone-no-ext js-input-phone'
                          - type: "phone_field"
                            field: :phone
                            label: "Work phone"
                            css_classes: "input-phone js-input-phone"
                          - type: 'select'
                            field: :preferred_phone
                            label: 'Preferred phone during business hours'
                            css_classes: 'js-preferred-phone'
                            include_blank: 'Please select one'
                            options:
                              'Cell Phone' : 1
                              'Home Phone' : 2
                              'Work Phone' : 3
                            input_size: 3

          - type: 'section'
            conditions:
            - 'multi_borrower_enabled'
            selector: 'js-additional_applicants'
            components:
              - type: 'component_header'
                text: 'Additional Co-borrowers'
                heading_level: 'h2'
                subtext: 'On this application, we need only contact details for additional co-borrowers. We will follow up with them for more information. There is a limit of %{ loan_application.account&.maximum_applicants } pairs or individuals. A pair has to be married and applying jointly, and generally shares assets.'
                hint: 'The name, email, and phone of your co-borrowers will be used across the application. Use legal names for the fastest process.'
              - type: 'recurring_section'
                add_btn_label: 'Add Co-borrower'
                max_limit: :max_additional_applicants
                button_first: true
                section_header: "Co-Borrower"
                section_index: 2
                options:
                  selector: 'js-additional_applicants'
                limit_reached_text: "You have reached the maximum number of parties to the application."
                resource: :additional_applicants
                components:
                  - type: 'section'
                    components:
                      - type: 'columned_fields'
                        fields:
                          - field: :first_name
                            label: 'First name'
                            css_classes: 'col-7 col-md-4 js-restrict-emoji js-name-validation'
                            only_mark_as_required: true
                          - field: :middle_initial
                            label: 'Middle initial'
                            input_size: 1

                      - type: 'section'
                        options:
                          selector: 'row'
                        components:
                          - type: 'text_field'
                            field: :last_name
                            label: 'Last name'
                            only_mark_as_required: true
                            selector: 'col-7 col-md-4 pr-0 mr-3 js-restrict-emoji js-name-validation'
                            wrapper_grid: 'col-12 col-md-12'

                          - type: "select"
                            field: :suffix
                            label: 'Suffix'
                            options: User::SUFFIX_VALUES
                            selector: 'col-3 col-md-2'

                      - type: 'checkbox'
                        field: :uses_alternate_name
                        label: 'Coborrower has an alternate name'
                        visibility_toggles:
                          selectors:
                            - "js-additional_coborrower_alternate_name_fields"
                          map:
                            - value: 'true'
                              show:
                                - "js-additional_coborrower_alternate_name_fields"

                      - type: 'columned_fields'
                        selector: 'js-additional_coborrower_alternate_name_fields'
                        fields:
                          - field: :alternate_first_name
                            label: 'Alternate first name'
                            css_classes: 'col-7 col-md-4'
                          - field: :alternate_middle_initial
                            label: 'Middle initial'
                            input_size: 1

                      - type: 'section'
                        options:
                          selector: 'row js-additional_coborrower_alternate_name_fields'
                        components:
                          - type: 'text_field'
                            field: :alternate_last_name
                            label: 'Alternate last name'
                            selector: 'col-7 col-md-4 pr-0 mr-3'
                            wrapper_grid: 'col-12 col-md-12'

                          - type: "select"
                            field: :alternate_suffix
                            label: 'Suffix'
                            options: User::SUFFIX_VALUES
                            selector: 'col-3 col-md-2'

                      - type: "email_field"
                        field: :email
                        label: "Email address"
                        input_size: 9
                        only_mark_as_required: true
                        validation:
                          method: check_unique_name_and_email
                          message: 'The names and emails of the Borrower and Co-Borrower match exactly, which will cause record-keeping issues. Please edit one or both names or emails to create unique users.'
                      - type: "phone_field"
                        field: :home_phone
                        label: "Home phone"
                        css_classes: 'input-phone-no-ext js-input-phone'
                      - type: "phone_field"
                        field: :cell_phone
                        label: "Cell phone"
                        css_classes: 'input-phone-no-ext js-input-phone'
                      - type: "phone_field"
                        field: :phone
                        label: "Work phone"
                        css_classes: "input-phone js-input-phone"
                      - type: 'select'
                        field: :preferred_phone
                        label: 'Preferred phone during business hours'
                        css_classes: 'js-preferred-phone'
                        include_blank: 'Please select one'
                        options:
                          'Cell Phone' : 1
                          'Home Phone' : 2
                          'Work Phone' : 3
                        input_size: 3
                  - type: 'component_header'
                    text: 'Are they applying jointly with spouse?'
                  - type: 'button_group'
                    field: :has_spouse
                    choices:
                      'Yes': true
                      'No': false
                    visibility_toggles:
                      selectors:
                        - "js-additional_coborrower_spouse"
                      map:
                        - value: 'true'
                          show:
                            - "js-additional_coborrower_spouse"
                  - type: 'section'
                    resource: :spouse
                    options:
                      selector: 'js-additional_coborrower_spouse'
                    components:
                      - type: 'columned_fields'
                        fields:
                          - field: :first_name
                            label: 'First name'
                            css_classes: 'col-7 col-md-4 js-restrict-emoji js-name-validation'
                            only_mark_as_required: true
                          - field: :middle_initial
                            label: 'Middle initial'
                            input_size: 1

                      - type: 'section'
                        options:
                          selector: 'row'
                        components:
                          - type: 'text_field'
                            field: :last_name
                            label: 'Last name'
                            only_mark_as_required: true
                            selector: 'col-7 col-md-4 pr-0 mr-3 js-restrict-emoji js-name-validation'
                            wrapper_grid: 'col-12 col-md-12'

                          - type: "select"
                            field: :suffix
                            label: 'Suffix'
                            options: User::SUFFIX_VALUES
                            selector: 'col-3 col-md-2'

                      - type: 'checkbox'
                        field: :uses_alternate_name
                        label: 'Coborrower has an alternate name'
                        visibility_toggles:
                          selectors:
                            - "js-additional_coborrower_spouse_alternate_name_fields"
                          map:
                            - value: 'true'
                              show:
                                - "js-additional_coborrower_spouse_alternate_name_fields"

                      - type: 'columned_fields'
                        selector: 'js-additional_coborrower_spouse_alternate_name_fields'
                        fields:
                          - field: :alternate_first_name
                            label: 'Alternate first name'
                            css_classes: 'col-7 col-md-4'
                          - field: :alternate_middle_initial
                            label: 'Middle initial'
                            input_size: 1

                      - type: 'section'
                        options:
                          selector: 'row js-additional_coborrower_spouse_alternate_name_fields'
                        components:
                          - type: 'text_field'
                            field: :alternate_last_name
                            label: 'Alternate last name'
                            selector: 'col-7 col-md-4 pr-0 mr-3'
                            wrapper_grid: 'col-12 col-md-12'

                          - type: "select"
                            field: :alternate_suffix
                            label: 'Suffix'
                            options: User::SUFFIX_VALUES
                            selector: 'col-3 col-md-2'

                      - type: "email_field"
                        field: :email
                        label: "Email address"
                        input_size: 9
                        only_mark_as_required: true
                        validation:
                          method: check_unique_name_and_email
                          message: 'The names and emails of the Borrower and Co-Borrower match exactly, which will cause record-keeping issues. Please edit one or both names or emails to create unique users.'
                      - type: "phone_field"
                        field: :home_phone
                        label: "Home phone"
                        css_classes: 'input-phone-no-ext js-input-phone'
                      - type: "phone_field"
                        field: :cell_phone
                        label: "Cell phone"
                        css_classes: 'input-phone-no-ext js-input-phone'
                      - type: "phone_field"
                        field: :phone
                        label: "Work phone"
                        css_classes: "input-phone js-input-phone"
                      - type: 'select'
                        field: :preferred_phone
                        label: 'Preferred phone during business hours'
                        css_classes: 'js-preferred-phone'
                        include_blank: 'Please select one'
                        options:
                          'Cell Phone' : 1
                          'Home Phone' : 2
                          'Work Phone' : 3
                        input_size: 3

borrower_loan:
  group: "Borrower"
  step_name: "Loan"
  step_identifier: :loan
  partial: "generic"
  sub_steps:
    - form:
        components:
          - type: 'analytics'
            value: "page_name:pws/application/mortgage/borrower/loan-details,page_url:/application/mortgage/borrower/loan-details/,funnel_step:borrower,funnel_step_name:loan,event_category:nil,event_action:nil,event_content:nil,funnel_name:mortgage application revised urla"
          - type: 'page_title'
            text: 'What kind of loan are you looking for?'
          - type: 'section_title'
            text: 'Loan'
          - type: 'section'
            legend: 'Loan'
            legend_sr_only: 'true'
            resource: :loan_application
            components:
              - type: 'radio_button_collection'
                label: 'Please select one.'
                legend: 'Please select one.'
                pdf_label: 'Application Type'
                legend_sr_only: 'true'
                field: :application_type
                options: :application_types_offered
                selector: 'js-application_type_multi_select'
                hints:
                  - value: 0
                    text: "Pre-qualifying gives you an idea of how much house you can afford based on basic financial information you provide."
                  - value: 2
                    text: "Refinance a property that you already own to replace your current mortgage, and to pay off other loans or to get cash."
                  - value: 3
                    text: "A revolving line of credit with a variable rate, similar to a credit card, for a set period of time."
                  - value: 4
                    text: "A one-time, lump sum taken out from the equity in your home, to be paid back over a fixed period of time."
                  - value: 5
                    text: "A Construction loan is used to finance the construction of a new home and—if needed—the purchase of a new lot. Upon the completion of construction, the loan converts to a permanent mortgage."
                visibility_toggles:
                  selectors:
                    - 'js-mortgage_type_section'
                    - 'js-pre_approval_and_purchase_components'
                    - 'js-purchase_components'
                    - 'js-real_estate_questions'
                    - 'js-prospective_properties_section'
                    - 'js-gift_asset_section'
                    - 'js-rental_income'
                    - 'js-other_loan_purpose'
                    - 'js-loan_type_and_amortization_terms_components'
                    - 'js-refi_components'
                    - 'js-refi_components_and_heloc'
                    - 'js-prospective-property_use'
                    - 'js-subject-property_use'
                    - 'js-property'
                    - 'js-property_header'
                    - 'js-prospective-property_header'
                    - 'js-lead-stage'
                    - 'js-property_contract'
                    - 'js-heloc'
                    - 'js-first_existing_mortgage'
                    - 'js-second_existing_mortgage'
                    - 'js-down_payment_gift'
                    - 'js-other_down_payment_source'
                    - 'js-construction-loan'
                    - 'js-construction-down-payments'
                    - 'js-construction-property-use'
                    - 'js-down-payments-methods'
                    - 'js-down-payment-gifts'
                  map:
                    - value: 0
                      show:
                        - 'js-real_estate_questions'
                        - 'js-pre_approval_and_purchase_components'
                        - 'js-prospective_properties_section'
                        - 'js-property_header'
                        - 'js-prospective-property_use'
                        - 'js-loan_type_and_amortization_terms_components'
                        - 'js-mortgage_type_section'
                        - 'js-down-payments-methods'
                        - 'js-down-payment-gifts'
                    - value: 1
                      show:
                        - 'js-pre_approval_and_purchase_components'
                        - 'js-property_header'
                        - 'js-lead-stage'
                        - 'js-purchase_components'
                        - 'js-loan_type_and_amortization_terms_components'
                        - 'js-mortgage_type_section'
                        - 'js-down-payments-methods'
                        - 'js-down-payment-gifts'
                    - value: 2
                      show:
                        - 'js-refi_components'
                        - 'js-refi_components_and_heloc'
                        - 'js-loan_type_and_amortization_terms_components'
                        - "js-mortgage_type_section"
                        - 'js-property'
                        - 'js-property_header'
                        - 'js-subject-property_use'
                    - value: 3
                      show:
                        - "js-heloc"
                        - 'js-property'
                        - 'js-property_header'
                        - 'js-subject-property_use'
                        - 'js-refi_components_and_heloc'
                    - value: 4
                      show:
                        - "js-heloc"
                        - 'js-property'
                        - 'js-property_header'
                        - 'js-subject-property_use'
                        - 'js-refi_components_and_heloc'
                    - value: 5
                      show:
                        - 'js-construction-loan'
                        - 'js-construction-down-payments'
                        - 'js-construction-property-use'
                        - 'js-down-payments-methods'
                        - 'js-down-payment-gifts'

              - type: 'hidden_field'
                field: :application_type
                selector: 'application_type_hidden_field'

              - type: 'hidden_field'
                field: :pre_approval
                selector: 'pre_approval_hidden_field'

              - type: 'section'
                conditions:
                  - 'not application_type_is_blank'
                components:
                  - type: 'section'
                    conditions:
                      - 'not home_equity_application_type'
                      - 'not construction_application_type'
                      - 'account_enabled_loan_type'
                    options:
                      selector: 'js-mortgage_type_section'
                    components:
                      - type: 'component_header'
                        text: 'What type of loan are you looking for?'
                      - type: 'body_paragraph'
                        content: "If you aren't certain which type to choose, you can skip this question and decide later."
                      - type: 'radio_button_collection'
                        field: :mortgage_type
                        legend: 'What type of loan are you looking for?'
                        legend_sr_only: 'true'
                        options: :mortgage_types_offered_short
                        hints:
                          - value: 1
                            text: 'Most mortgages are conventional mortgages. If none of the other options apply to you, select this option.'
                          - value: 2
                            text: 'The Federal Housing Administration (FHA) loan program is designed to assist low-to-moderate-income people who are unable to make a large down payment.'
                          - value: 3
                            text: "A mortgage loan for eligible American veterans or their surviving spouse. To qualify for this loan, you'll need to provide evidence of military service."
                          - value: 4
                            text: 'The United States Department of Agriculture (USDA) loan program is designed to help low-to-moderate-income people in rural areas buy homes by enabling zero or low down payments.'
                          - value: 6
                            text: "The VA Streamline (IRRRL) loan lowers your interest rate by refinancing your existing VA home loan. This may be the right product for you if you already have a VA loan, and you don't need to take any cash out during your refinancing."
                        visibility_toggles:
                          selectors:
                            - 'js-mortgage-type-non-usda'
                            - 'js-mortgage-type-conventional'
                            - 'js-mortgage-type-fha'
                            - 'js-mortgage-type-va'
                            - 'js-mortgage-type-va-irrrl'
                            - 'js-mortgage-type-va-irrrl-header'
                          map:
                            - value: 1
                              show:
                                - 'js-mortgage-type-non-usda'
                                - 'js-mortgage-type-conventional'
                            - value: 2
                              show:
                                - 'js-mortgage-type-fha'
                                - 'js-mortgage-type-non-usda'
                            - value: 3
                              show:
                                - 'js-mortgage-type-va'
                                - 'js-mortgage-type-non-usda'
                            - value: 6
                              show:
                                - 'js-mortgage-type-va-irrrl'
                                - 'js-mortgage-type-va-irrrl-header'

                  - type: 'section_title'
                    conditions:
                      - 'pre_approval_or_purchase_application_type'
                    text: 'Your situation'
                    selector: 'js-pre_approval_and_purchase_components'

                  # HELOC
                  - type: 'section'
                    legend: 'How do you plan to use your loan?'
                    heading_level: 'h2'
                    hint: 'We use this info to help find the best product for you. We are required to collect this information as part of your application.'
                    conditions:
                      - 'not pre_approval_application_type'
                      - 'not purchase_or_construction_application_type'
                    options:
                      selector: 'js-heloc'
                    components:
                      - type: 'radio_button_collection'
                        field: :loan_use_heloc
                        options: LOAN_USAGE
                        selector: 'js-loan_use'
                        visibility_toggles:
                          selectors:
                            - 'js-other_loan_purpose'
                          map:
                            - value: 'OTHER'
                              show:
                                - 'js-other_loan_purpose'
                      - type: 'text_field'
                        field: :loan_use_other
                        label: 'Loan purpose'
                        selector: 'js-other_loan_purpose'
                  - type: 'section'
                    conditions:
                      - 'not home_equity_application_type'
                      - 'not construction_application_type'
                      - 'account_enabled_amortization_type'
                    options:
                      selector: 'js-mortgage-type-non-usda'
                    components:
                      - type: 'radio_button_collection'
                        label: 'Do you have a preference for the kind of interest rate you’re looking for?'
                        legend: 'Do you have a preference for the kind of interest rate you’re looking for?'
                        legend_sr_only: 'true'
                        hint: 'If you’re not sure at this time, you can skip this question and discuss with us later.'
                        field: :amortization
                        options: amortization_types_offered
                        hints:
                          - value: '1'
                            text: 'This type of loan has a set interest rate and a monthly payment that will remain the same over the entire duration of the loan. With a fixed rate mortgage, you benefit from a consistent payment that you can budget from.'
                          - value: '2'
                            text: 'A mortgage whose rate of interest is adjusted periodically to reflect market conditions. An ARM permits a borrower to lower their initial payments in exchange for the risk of interest rate changes and increased monthly payments due to upward rate adjustments.'
                          - value: '3'
                            text: 'A mortgage with low initial monthly payments which gradually increase over a specified time frame. These plans are mostly geared towards young men and women who cannot afford large payments now, but can realistically expect to do better financially in the future. A graduated payment mortgage lets borrowers save at the present time by paying low monthly amounts, however, the overall expense of a graduated-payment mortgage loan is higher than that of conventional mortgages.'
                        selector: 'js-loan_type_and_amortization_terms_components'
                        visibility_toggles:
                          selectors:
                            - 'js-amortization_terms_header_fixed'
                            - 'js-amortization_terms_header_arm'
                            - 'js-amortization_conventional_fixed'
                            - 'js-amortization_conventional_arm'
                            - 'js-amortization_conventional_gpm'
                            - 'js-amortization_fha_fixed'
                            - 'js-amortization_fha_arm'
                            - 'js-amortization_fha_gpm'
                            - 'js-amortization_va_fixed'
                            - 'js-amortization_va_arm'
                            - 'js-amortization_va_gpm'
                          map:
                            - value: 1
                              show:
                                - 'js-amortization_terms_header_fixed'
                                - 'js-amortization_conventional_fixed'
                                - 'js-amortization_fha_fixed'
                                - 'js-amortization_va_fixed'
                            - value: 2
                              show:
                                - 'js-amortization_terms_header_arm'
                                - 'js-amortization_conventional_arm'
                                - 'js-amortization_fha_arm'
                                - 'js-amortization_va_arm'
                            - value: 3
                              show:
                                - 'js-amortization_terms_header_fixed'
                                - 'js-amortization_conventional_gpm'
                                - 'js-amortization_fha_gpm'
                                - 'js-amortization_va_gpm'

                      - type: 'component_header'
                        conditions:
                          - 'account_enabled_any_amortization_terms'
                        text: 'Which loan term is most appealing to you at this time?'
                        hint: 'Shorter terms typically have higher monthly payments, but lower interest rates and less interest paid over the life of the loan. Longer terms typically have lower payments, but higher overall interest. If you’re not sure which one you’d like at this time, go ahead and skip this question and we’ll calculate all the details of your loan together.'
                        selector: 'js-amortization_terms_header_fixed'
                        aria_hidden: 'true'

                      - type: 'component_header'
                        conditions:
                          - 'account_enabled_any_amortization_terms'
                        text: "What fixed payment term is most appealing to you at this time?"
                        hint: 'Shorter terms typically have higher monthly payments, but lower interest rates and less interest paid over the life of the loan. Longer terms typically have lower payments, but higher overall interest. If you’re not sure which one you’d like at this time, go ahead and skip this question and we’ll calculate all the details of your loan together.'
                        selector: 'js-amortization_terms_header_arm'
                        aria_hidden: 'true'
                      - type: 'section'
                        options:
                          selector: 'js-mortgage-type-conventional'
                        components:
                          - type: 'section'
                            conditions:
                              - 'account_enabled_amortization_conventional_fixed_terms'
                            options:
                              selector: 'js-amortization_conventional_fixed'
                            components:
                              - type: 'radio_button_collection'
                                field: :amort_terms_conventional_fixed
                                options: amortization_conventional_fixed_terms

                          - type: 'section'
                            conditions:
                              - 'account_enabled_amortization_conventional_arm_terms'
                            options:
                              selector: 'js-amortization_conventional_arm'
                            components:
                              - type: 'radio_button_collection'
                                field: :amort_terms_conventional_arm
                                options: amortization_conventional_arm_terms

                          - type: 'section'
                            conditions:
                              - 'account_enabled_amortization_conventional_gpm_terms'
                            options:
                              selector: 'js-amortization_conventional_gpm'
                            components:
                              - type: 'radio_button_collection'
                                field: :amort_terms_conventional_gpm
                                options: amortization_conventional_gpm_terms


                      - type: 'section'
                        options:
                          selector: 'js-mortgage-type-fha'
                        components:
                          - type: 'section'
                            conditions:
                              - 'account_enabled_amortization_fha_fixed_terms'
                            options:
                              selector: 'js-amortization_fha_fixed'
                            components:
                              - type: 'radio_button_collection'
                                field: :amort_terms_fha_fixed
                                legend: 'Which loan term is most appealing to you at this time?'
                                hint: 'Shorter terms typically have higher monthly payments, but lower interest rates and less interest paid over the life of the loan. Longer terms typically have lower payments, but higher overall interest. If you’re not sure which one you’d like at this time, go ahead and skip this question and we’ll calculate all the details of your loan together.'
                                legend_sr_only: 'true'
                                options: amortization_fha_fixed_terms

                          - type: 'section'
                            conditions:
                              - 'account_enabled_amortization_fha_arm_terms'
                            options:
                              selector: 'js-amortization_fha_arm'
                            components:
                              - type: 'radio_button_collection'
                                field: :amort_terms_fha_arm
                                options: amortization_fha_arm_terms

                          - type: 'section'
                            conditions:
                              - 'account_enabled_amortization_fha_gpm_terms'
                            options:
                              selector: 'js-amortization_fha_gpm'
                            components:
                              - type: 'radio_button_collection'
                                field: :amort_terms_fha_gpm
                                options: amortization_fha_gpm_terms

                      - type: 'section'
                        options:
                          selector: 'js-mortgage-type-va'
                        components:
                          - type: 'section'
                            conditions:
                              - 'account_enabled_amortization_va_fixed_terms'
                            options:
                              selector: 'js-amortization_va_fixed'
                            components:
                              - type: 'radio_button_collection'
                                field: :amort_terms_va_fixed
                                legend: 'Which loan term is most appealing to you at this time?'
                                legend_sr_only: 'true'
                                hint: 'Shorter terms typically have higher monthly payments, but lower interest rates and less interest paid over the life of the loan. Longer terms typically have lower payments, but higher overall interest. If you’re not sure which one you’d like at this time, go ahead and skip this question and we’ll calculate all the details of your loan together.'
                                options: amortization_va_fixed_terms

                          - type: 'section'
                            conditions:
                              - 'account_enabled_amortization_va_arm_terms'
                            options:
                              selector: 'js-amortization_va_arm'
                            components:
                              - type: 'radio_button_collection'
                                field: :amort_terms_va_arm
                                legend: "What fixed payment term is most appealing to you at this time?"
                                legend_sr_only: 'true'
                                hint: 'Shorter terms typically have higher monthly payments, but lower interest rates and less interest paid over the life of the loan. Longer terms typically have lower payments, but higher overall interest. If you’re not sure which one you’d like at this time, go ahead and skip this question and we’ll calculate all the details of your loan together.'
                                options: amortization_va_arm_terms

                          - type: 'section'
                            conditions:
                              - 'account_enabled_amortization_va_gpm_terms'
                            options:
                              selector: 'js-amortization_va_gpm'
                            components:
                              - type: 'radio_button_collection'
                                field: :amort_terms_va_gpm
                                options: amortization_va_gpm_terms

                  - type: 'section'
                    conditions:
                      - 'refinancing_application_type'
                      - 'account_enabled_amortization_type'
                      - 'account_enabled_amortization_va_irrrl_fixed_terms'
                    options:
                      selector: 'js-mortgage-type-va-irrrl'
                    components:
                      - type: 'hidden_field'
                        field: :amortization
                        selector: 'js-amortization-hidden-field'
                        value: '1'
                        disabled: true
                      - type: 'component_header'
                        text: "What fixed payment term is most appealing to you at this time?"
                        hint: 'Shorter terms typically have higher monthly payments, but lower interest rates and less interest paid over the life of the loan. Longer terms typically have lower payments, but higher overall interest. If you’re not sure which one you’d like at this time, go ahead and skip this question and we’ll calculate all the details of your loan together.'
                        selector: 'js-mortgage-type-va-irrrl-header'
                        aria_hidden: 'true'
                      - type: 'radio_button_collection'
                        legend: "What fixed payment term is most appealing to you at this time?"
                        legend_sr_only: 'true'
                        hint: 'Shorter terms typically have higher monthly payments, but lower interest rates and less interest paid over the life of the loan. Longer terms typically have lower payments, but higher overall interest. If you’re not sure which one you’d like at this time, go ahead and skip this question and we’ll calculate all the details of your loan together.'
                        field: :amort_terms_va_irrrl_fixed
                        options: amortization_va_irrrl_fixed_terms


                  - type: 'section'
                    legend: 'Which loan term is most appealing to you at this time?'
                    heading_level: 'h2'
                    hint: 'Shorter terms typically have higher monthly payments, but lower interest rates and less interest paid over the life of the loan. Longer terms typically have lower payments, but higher overall interest. If you’re not sure which one you’d like at this time, go ahead and skip this question and we’ll calculate all the details of your loan together.'
                    conditions:
                      - 'hel_loan_application_type'
                      - 'account_enabled_hel_terms'
                    components:
                      - type: 'hidden_field'
                        field: :amortization
                        value: '1'
                      - type: 'radio_button_collection'
                        field: :amortization_term
                        options: amortization_hel_terms
                        hints:
                          - value: 30
                            text: 'Not available for investment properties'
                  - type: 'section'
                    conditions:
                      - 'refinancing_application_type'
                      - 'account_enabled_loan_type'
                    options:
                      selector: 'js-refi_components'
                    components:
                      - type: 'section'
                        options:
                            selector: 'js-refi_components'
                        components:
                          - type: "component_header"
                            text: "Will you be taking cash out from this refinance?"
                            hint: "A cash-out refinance replaces your existing mortgage with a new one for more than you owe on your house. The difference goes to you in cash and you can spend it on home improvements, debt consolidation or other financial needs. You must have equity built up in your house to use a cash-out refinance. In contrast, traditional refinancing replaces your existing mortgage with a new one for the same balance."
                          - type: "button_group"
                            field: :taking_cashout
                            selector: "js-refi_amount_input js-taking_cashout"
                            visibility_toggles:
                              selectors:
                                - 'js-purpose_of_refinance'
                                - 'js-first_mortgage_remaining_balance'
                                - 'js-cashout_calculator'
                                - 'js-non_cashout_calculator'
                              map:
                                - value: 'true'
                                  show:
                                    - 'js-purpose_of_refinance'
                                    - 'js-first_mortgage_remaining_balance'
                                    - 'js-cashout_calculator'
                                    - 'js-non_cashout_calculator'
                                - value: 'false'
                                  show:
                                    - 'js-first_mortgage_remaining_balance'
                                    - 'js-non_cashout_calculator'
                      - type: 'section'
                        legend: "How will you be using the refinance?"
                        options:
                          selector: 'js-purpose_of_refinance'
                        components:
                          - type: 'radio_button_collection'
                            field: :loan_use_refi
                            options: LOAN_USAGE
                            selector: 'js-loan_use'
                            visibility_toggles:
                              selectors:
                                - 'js-other_loan_purpose'
                              map:
                                - value: 'OTHER'
                                  show:
                                    - 'js-other_loan_purpose'
                          - type: 'text_field'
                            field: :loan_use_other
                            label: 'Loan purpose'
                            selector: 'js-other_loan_purpose'
                      - type: 'section'
                        options:
                          selector: 'js-cashout_calculator'
                        components:
                          - type: "body_paragraph"
                            content: "Let us know how much money you want to allocate for each."
                      - type: 'section'
                        options:
                          selector: 'js-first_mortgage_remaining_balance'
                        components:
                          - type: "currency"
                            field: :first_mortgage_remaining_balance
                            label: "Current Mortgage"
                            selector: "js-refi_amount_input js-first_mortgage_balance"
                      - type: 'section'
                        options:
                            selector: 'js-cashout_calculator'
                        components:
                          - type: "currency"
                            field: :non_mortgage_payoff_amount
                            label: "Other Debts"
                            selector: 'js-refi_amount_input js-non_mortgage_payoff_amount'
                          - type: "currency"
                            field: :desired_cashout_amount
                            label: "Cash"
                            css_classes: "input-medium input-dollar"
                            selector: 'js-refi_amount_input js-desired_cashout_amount'
                      - type: 'section'
                        options:
                            selector: 'js-non_cashout_calculator'
                        components:
                          - type: "currency"
                            field: :loan_amount
                            label: "Total loan amount"
                            locked: true
                            selector: 'js-total_loan_amount'
          - type: 'section'
            aria_labelledby: 'property_group_title_1618532474903'
            conditions:
              - 'pre_approval_or_purchase_application_type'
            options:
              selector: 'js-prospective-calculator'
            components:
              - type: "component_header"
                text: "What is your preferred loan amount and down payment?"
              - type: 'currency'
                field: :property_estimated_purchase_price
                label: 'Estimated Purchase Price'
                selector: 'js-loan-calc-purchase-price'
                input_size: 5
                hint: "This field is required to calculate loan amount"
              - type: 'percentage_field'
                field: :property_calculator_down_payment_percentage
                label: 'Down Payment Percentage'
                input_size: 5
                selector: 'js-loan-calc-down-payment-percentage'
                hint: "This field is required to calculate loan amount"
              - type: 'currency'
                field: :property_calculator_down_payment_amount
                selector: 'js-loan-calc-down-payment-amount'
                label: 'Down Payment Amount'
                input_size: 5
              - type: 'currency'
                field: :property_preferred_borrowed_amount
                locked: true
                label: 'Loan Amount'
                input_size: 5
                selector: 'js-loan-calc-loan-amount'
          - type: 'section'
            resource: :loan_application
            components:
                  #Preapproval and Purchase Path
                  - type: 'section'
                    legend: 'How does this loan fit into your overall plans?'
                    conditions:
                      - 'pre_approval_or_purchase_application_type'
                    options:
                      selector: 'js-pre_approval_and_purchase_components'
                    components:
                      - type: 'checkbox_collection'
                        field: :overall_plans
                        options: OVERALL_PLANS
                      - type: 'component_header'
                        text: "Please share any circumstances around your loan application that you'd like us to know about"
                        hint: "Sometimes the circumstances surrounding your loan can affect what kind of loan product you get. For instance, if you’re looking to get cash out of your equity for a renovation project, and are not sure whether to get a HELOC or refinance, you might mention this here."
                        id: 'extra_circumstances_1618329457584'
                      - type: 'text_area'
                        field: :extra_circumstances
                        aria_labelledby: 'extra_circumstances_1618329457584'

                  - type: 'section'
                    conditions:
                      - 'purchase_application_type'
                    options:
                      selector: 'js-purchase_components'
                    components:
                      - type: 'button_group'
                        field: :lead_stage
                        legend: 'In what stage are you in the home buying process?'
                        choices:
                          Actively searching: 'search'
                          Under contract: 'contract'
                        selector: 'js-lead-stage'
                        visibility_toggles:
                          selectors:
                            - 'js-real_estate_questions'
                            - 'js-prospective_properties_section'
                            - 'js-property-other_new_mortgage_loans'
                            - 'js-property'
                            - 'js-property_contract'
                            - 'js-prospective-property_use'
                            - 'js-subject-property_use'
                            - 'js-property_header'
                            - 'js-prospective_property_header'
                          map:
                            - value: 'search'
                              show:
                                - 'js-prospective_property_header'
                                - 'js-real_estate_questions'
                                - 'js-prospective_properties_section'
                                - 'js-prospective-property_use'
                                - 'js-property-other_new_mortgage_loans'
                            - value: 'contract'
                              show:
                                - 'js-property_header'
                                - 'js-property'
                                - 'js-property_contract'
                                - 'js-subject-property_use'


          - type: 'section'
            conditions:
              - 'not application_type_is_blank'
            components:
              # construction-loan
              - type: 'section'
                resource: :subject_properties
                conditions:
                  - 'construction_application_type'
                options:
                  selector: 'js-construction-loan'
                components:
                  - type: 'component_header'
                    text: 'Do you already own the lot where construction will take place?'
                  - type: 'button_group'
                    selector: 'js-construction-property-own'
                    field: :own
                    choices:
                      'Yes': true
                      'No': false
                    visibility_toggles:
                      selectors:
                        - 'js-construction-lot-owned'
                        - 'js-construction-lot-not-owned'
                        - 'js-construction-address'
                        - 'js-construction-title-owners'
                      map:
                        - value: "true"
                          show:
                            - 'js-construction-address'
                            - 'js-construction-title-owners'
                            - 'js-construction-lot-owned'
                        - value: "false"
                          show:
                            - 'js-construction-address'
                            - 'js-construction-lot-not-owned'
              - type: 'section'
                resource: :subject_properties
                options:
                  selector: 'js-sp-address'
                conditions:
                  - 'construction_application_type'
                  - 'enable_subject_property'
                components:
                  - type: 'component_header'
                    text: 'Please provide details below about your lot.'
                    selector: 'js-construction-lot-owned'
                  - type: 'component_header'
                    text: 'Please tell us what you know about your lot.'
                    selector: 'js-construction-lot-not-owned'
                  - type: 'address_one_field'
                    selector: 'js-construction-address'
                    field: :address1
                    label: 'Street Address'
                    input_size: 9
                  - type: 'text_field'
                    selector: 'js-construction-address'
                    field: :address2
                    label: 'Apt/Unit/Suite (if applicable)'
                    input_size: 9
                    max_length: 10
                  - type: 'text_field'
                    selector: 'js-construction-address'
                    field: :city
                    label: 'City'
                    input_size: 9
                  - type: 'select'
                    selector: 'js-construction-address'
                    field: :state
                    options: configured_state_options
                    input_classes: 'js-recurring-state-with-county'
                    input_size: 3
                    include_blank: 'Please select one'
                    label: 'State'
                  - type: 'zip_field'
                    field: :zip
                    selector: 'js-construction-address'
                    label: 'Zip Code'
                    input_size: 3
                  - type: 'select'
                    field: :county_fips
                    selector: 'js-construction-address'
                    label: 'County'
                    options: county_options
                    input_size: 5
                    input_classes: 'js-counties'
                    disabled: 'state_not_present?'
                    css_classes: 'col-md-6'
                  - type: 'select'
                    field: :country
                    selector: 'js-construction-address'
                    options: country_options
                    input_size: 5
                    input_classes: 'js-countries'
                    label: 'Country'
                  - type: 'section'
                    selector: 'js-spouse-name-section'
                    conditions:
                      - 'borrower_married'
                      - 'not coborrower_is_borrower_spouse'
                    components:
                    - type: 'component_header'
                      text: 'What is your spouse’s full name?'
                      hint: 'This is required by Community Property States'
                    - type: 'text_field'
                      field: :primary_applicant_spouse_name
                  - type: 'component_header'
                    selector: 'js-construction-title-owners'
                    text: ''
                    subtext: 'This lot is also currently owned by the following co-borrower(s)'
                  - type: 'checkbox_collection'
                    selector: 'js-construction-title-owners'
                    field: :title_owners
                    options: coapplicants
                  - type: 'date_select'
                    field: :start_date
                    selector: 'js-construction-lot-owned'
                    label: 'Year Lot Acquired'
                    exclude_fields:
                      - day
                      - month
                    year_css: 'col-3 col-md-2'
                    recurse:
                      date_difference: 63072000
                  - type: 'currency'
                    selector: 'js-construction-property_value js-construction-lot-owned js-construction-owned-value'
                    field: :property_value
                    label: 'Original Lot Cost'
                  - type: 'currency'
                    field: :monthly_hoa
                    selector: 'js-construction-hoa js-construction-lot-owned js-construction-owned-hoa'
                    label: 'Anticipated HOA Dues'
                  - type: 'currency'
                    selector: 'js-construction-property_value js-construction-lot-not-owned js-construction-not-owned-value'
                    field: :property_value
                    label: 'Price of Lot'
                  - type: 'currency'
                    field: :monthly_hoa
                    selector: 'js-construction-hoa js-construction-lot-not-owned js-construction-not-owned-hoa'
                    label: 'Anticipated Monthly HOA Dues(if known)'
                  - type: 'component_header'
                    selector: 'js-construction-lot-owned'
                    text: 'Are there any outstanding liens on the lot?'
                  - type: 'button_group'
                    field: :any_outstanding_liens
                    selector: 'js-construction-lot-owned js-outstanding-liens'
                    choices:
                      'Yes': true
                      'No': false
                    visibility_toggles:
                      selectors:
                        - 'js-lien_amount'
                      map:
                        - value: "true"
                          show:
                            - 'js-lien_amount'
                  - type: 'currency'
                    field: :lien_amount
                    selector: 'js-lien_amount'
                    label: 'Outstanding liens total'

              # Show if pre aproval or during actively searching purchase
              - type: 'section_title'
                id: 'property_group_title_1618532474903'
                conditions:
                  - 'not refinancing_or_home_equity_application_type'
                  - 'not construction_application_type'
                text: 'Property'
                selector: 'js-prospective_property_header'

              # only displayed if enabled from account and pre-approval or browsing/search purchase
              - type: 'section'
                aria_labelledby: 'property_group_title_1618532474903'
                resource: :loan_application
                conditions:
                  - 'pre_approval_or_purchase_application_type'
                  - 'enable_realtor_referral'
                options:
                  selector: 'js-real_estate_questions'
                components:
                  - type: 'hidden_field'
                    field: :enabled_realtor_referral
                    selector: 'js-enabled_realtor_referral'
                    disabled: true
                  - type: 'component_header'
                    text: 'Are you already working with a real estate agent?'
                    hint: 'If you already have a real estate agent, you will have the ability to add them to your loan transaction to keep them in the loop after you submit your application.'

                  - type: 'button_group'
                    field: :has_realtor
                    visibility_toggles:
                      selectors:
                        - 'js-wants_real_estate_question'
                      map:
                        - value: 'false'
                          show:
                            - 'js-wants_real_estate_question'


                  # only displayed if enabled from account and has_realtor is false
                  - type: 'component_header'
                    text: 'Would you like us to refer you to one of our real estate agents in your area?'
                    selector: 'js-wants_real_estate_question'
                  - type: 'button_group'
                    field: :wants_realtor
                    selector: 'js-wants_real_estate_question'

              - type: 'component_header'
                conditions:
                  - 'pre_approval_or_purchase_application_type'
                text: 'Where are you looking for a property?'
                hint: "The county in which the property is located can affect details of your loan. We will revisit this later on if you aren't sure."
                selector: 'js-prospective_properties_section'

              - type: 'section'
                aria_labelledby: 'property_group_title_1618532474903'
                conditions:
                  - 'pre_approval_or_purchase_application_type'
                resource: 'prospective_properties'
                options:
                  selector: 'js-prospective_properties_section'
                  fieldset_legend: 'Prospective property location'
                components:
                  - type: 'text_field'
                    field: :city
                    label: 'City'
                    css_classes: 'col-md-6 js-input-city'
                  - type: 'select'
                    field: :state
                    label: 'State'
                    options: configured_state_options
                    input_classes: 'js-recurring-state-with-county'
                    input_size: 3
                    include_blank: 'Please select one'
                  - type: 'select'
                    field: :county_fips
                    label: 'County'
                    options: county_options
                    input_size: 5
                    input_classes: 'js-counties'
                    disabled: 'state_not_present?'
                    css_classes: 'col-md-6'

              # Property show for purchase under contract, heloc, refi
              - type: 'section'
                aria_labelledby: 'property_group_title_1618532474903'
                conditions:
                  - 'not pre_approval_application_type'
                  - 'not construction_application_type'
                  - 'enable_subject_property'
                resource: :subject_properties
                options:
                  selector: 'js-property'
                components:
                  - type: 'section_title'
                    id: 'property_group_title_1618532474903'
                    text: 'Property'
                    selector: 'js-property_header'
                    conditions:
                      - 'refinancing_or_home_equity_application_type'
                  - type: 'component_header'
                    conditions:
                      - 'refinancing_or_home_equity_application_type'
                    text: 'Tell us about the property to be considered for this loan'
                    hint: "This is your current property we'll be looking at to determine your loan. We'll collect any additional properties you own later in the application. If you don't know the exact values, provide your best estimate. We can always revisit this information with you later in the process."
                    selector: 'js-refi_components_and_heloc'
                  - type: 'component_header'
                    conditions:
                      - 'purchase_application_type'
                    text: 'What property are you trying to buy?'
                    selector: 'js-property_contract'
                  - type: 'section'
                    conditions:
                      - 'refinancing_or_home_equity_application_type'
                    components:
                      - type: section
                        conditions:
                          - 'current_address_is_own?'
                          - 'not must_display_existing_properties'
                        components:
                          - type: 'checkbox'
                            field: :is_my_current_address
                            label: 'I’m applying for a loan on the property where I live.'
                            checkboxes_toggles:
                              conditions:
                                - 'current_address_is_own?'
                              values:
                                - value: true
                                  toggles:
                                    - map:
                                      - value: true
                                        attribute: 'checked'
                                        selector:
                                          - 'js-subject_property_property_use_1'
                            visibility_toggles:
                              selectors:
                                - 'js-sp-address'
                              map:
                              - value: 'false'
                                show:
                                  - "js-sp-address"
                      - type: 'section'
                        conditions:
                          - 'must_display_existing_properties'
                        components:
                          - type: "radio_button_collection"
                            field: :borrower_new_property_token
                            legend: "Please select a property"
                            legend_sr_only: 'true'
                            options: :borrower_existing_properties_for_refi
                            selector: 'js-refi_existing_properties'
                            visibility_toggles:
                              selectors:
                                - 'js-sp-address'
                              map:
                              - value: 0
                                show:
                                  - "js-sp-address"
                      - type: 'section'
                        conditions:
                          - 'not must_display_existing_properties'
                        components:
                          - type: 'hidden_field'
                            field: :borrower_new_property_token
                            value: 0

                  - type: 'section'
                    options:
                      selector: 'js-sp-address'
                    components:
                      - type: 'address_one_field'
                        field: :address1
                        label: 'Street Address'
                        input_size: 9
                      - type: 'text_field'
                        field: :address2
                        label: 'Apt/Unit/Suite (if applicable)'
                        input_size: 9
                        max_length: 10
                      - type: 'text_field'
                        field: :city
                        label: 'City'
                        input_size: 9
                      - type: 'select'
                        field: :state
                        options: configured_state_options
                        input_classes: 'js-recurring-state-with-county'
                        input_size: 3
                        include_blank: 'Please select one'
                        label: 'State'
                      - type: 'zip_field'
                        field: :zip
                        label: 'Zip'
                        input_size: 3
                      - type: 'select'
                        field: :county_fips
                        label: 'County'
                        options: county_options
                        input_size: 5
                        input_classes: 'js-counties'
                        disabled: 'state_not_present?'
                        css_classes: 'col-md-6'
                      - type: 'select'
                        field: :country
                        options: country_options
                        input_size: 5
                        input_classes: 'js-countries'
                        label: 'Country'
                      - type: 'section'
                        selector: 'js-spouse-name-section'
                        conditions:
                          - 'borrower_married'
                          - 'not coborrower_is_borrower_spouse'
                        components:
                          - type: 'component_header'
                            text: 'What is your spouse’s full name?'
                            hint: 'This is required by Community Property States'
                          - type: 'text_field'
                            field: :primary_applicant_spouse_name
                  - type: section
                    conditions:
                      - 'coborrower?'
                    components:
                      - type: 'applicant_select_shared'
                        field: :shared_with_coborrowers_tokens
                        label: 'Which co-borrowers also own this property (if any)?'
                        legend: 'Which co-borrowers also own this property (if any)?'
                        legend_sr_only: true
                        single_coapplicant_label: 'Property is owned with the Co-borrower'
                  - type: 'button_group'
                    legend: 'Are you applying for any other new mortgage loans on this property?'
                    field: :has_other_new_mortgage_loans
                    visibility_toggles:
                      selectors:
                        - 'js-total_other_new_mortgage_loans'
                      map:
                        - value: 'true'
                          show:
                            - 'js-total_other_new_mortgage_loans'
                  - type: 'currency'
                    field: :total_other_new_mortgage_loans
                    label: 'Total Other New Mortgage Loans'
                    selector: 'js-total_other_new_mortgage_loans'
                    input_size: 5
                  - type: 'section'
                    conditions:
                      - 'purchase_application_type'
                    components:
                      - type: 'currency'
                        field: :monthly_hoa
                        label: 'Monthly HOA Dues'
                        input_size: 5
                      - type: 'currency'
                        field: :other_property_related_monthly_payments
                        label: 'Other property-related monthly payments'
                        input_size: 5
                        hint: "Other property-related monthly payments can include Flood Insurance."
                  - type: 'button_group'
                    legend: 'Do you intend to receive any rental income on this property?'
                    field: :rental_income_status
                    visibility_toggles:
                      selectors:
                        - 'js-purchase_monthly_rental_income'
                      map:
                        - value: 'true'
                          show:
                            - 'js-purchase_monthly_rental_income'
                  - type: 'currency'
                    field: :rental_income
                    label: 'Monthly Rental Income'
                    selector: 'js-purchase_monthly_rental_income'
                    input_size: 5

                  - type: 'section'
                    conditions:
                      - 'purchase_application_type'
                    options:
                      selector: 'js-purchase-property_types'
                    components:
                      - type: "radio_button_collection"
                        label: "Property type"
                        field: :property_type
                        legend: 'Property type'
                        legend_sr_only: 'true'
                        options: account_property_types
                        selector: 'js-property_types'
                        hints:
                        - value: 4
                          text: 'A stand-alone structure with its own lot intended for one family.'
                        - value: 5
                          text: 'Multiple separate housing units for residential inhabitants are contained within one building or several buildings within one complex, such as an apartment building or a duplex.'
                        visibility_toggles:
                          selectors:
                          - 'js-number_of_units'
                          map:
                          - value: 5
                            show:
                            - 'js-number_of_units'
                      - type: 'number_field'
                        field: :no_of_units
                        label: 'Number of units'
                        selector: 'js-number_of_units'
                        input_size: 5

              - type: 'section'
                aria_labelledby: 'property_group_title_1618532474903'
                conditions:
                  - 'pre_approval_or_purchase_application_type'
                  - 'refinancing_application_type'
                options:
                  selector: 'js-prospective-property_use'
                components:
                  - type: 'radio_button_collection'
                    label: 'How will you be using this property?'
                    selector: 'js-property_use_selector'
                    field: :prospective_property_property_use
                    options: URLA_PROPERTY_USES_EXCEPT_OTHER
                    hints:
                      - value: 2
                        text: 'You will live in the property on a part-time basis and will not generate income from the property when not occupying it.'
                      - value: 3
                        text: 'You will not live in the property full-time and generate rental income from it.'
                    visibility_toggles:
                      selectors:
                        - 'js-occupancy_length'
                      map:
                        - value: 1
                          show:
                            - 'js-occupancy_length'

              - type: 'section'
                aria_labelledby: 'property_group_title_1618532474903'
                conditions:
                  - 'not pre_approval_application_type'
                  - 'not construction_application_type'
                  - 'not home_equity_application_type'
                options:
                  selector: 'js-subject-property_use'
                components:
                  - type: 'radio_button_collection'
                    legend: 'How are you using this property?'
                    selector: 'js-property_use_selector'
                    css_classes: 'js-subject_property_property_use'
                    field: :subject_property_property_use
                    options: URLA_PROPERTY_USES_EXCEPT_OTHER
                    hints:
                      - value: 2
                        text: 'You live in the property on a part-time basis and do not generate income from the property when not occupying it.'
                      - value: 3
                        text: 'You do not live in the property full-time and generate rental income from it.'
                    visibility_toggles:
                      selectors:
                        - 'js-occupancy_length'
                      map:
                        - value: 1
                          show:
                            - 'js-occupancy_length'

              - type: 'checkbox'
                aria_labelledby: 'property_group_title_1618532474903'
                conditions:
                  - 'purchase_application_type'
                  - 'refinancing_application_type'
                field: :subject_property_mixed_use
                label: 'This is a mixed use property.'
                hint: 'Check this box if you will occupy and set aside space within the property to operate your own business.'
                selector: 'js-property_contract js-purchase-and-contract-mixed-use'

              - type: 'section'
                conditions:
                  - 'construction_application_type'
                options:
                  selector: 'js-construction-down-payments js-construction-subject-calculator'
                components:
                  - type: "component_header"
                    text: "Please provide some financial details about the construction"
                  - type: 'currency'
                    field: :property_estimated_purchase_price
                    label: 'Construction Costs'
                    selector: 'js-loan-calc-purchase-price'
                    input_size: 5
                  - type: 'percentage_field'
                    field: :property_calculator_down_payment_percentage
                    label: 'Down Payment Percentage'
                    input_size: 5
                    selector: 'js-loan-calc-down-payment-percentage'
                  - type: 'currency'
                    field: :property_calculator_down_payment_amount
                    selector: 'js-loan-calc-down-payment-amount'
                    label: 'Down Payment Amount'
                    input_size: 5
                  - type: 'currency'
                    field: :property_preferred_borrowed_amount
                    locked: true
                    label: 'Loan Amount'
                    input_size: 5
                    selector: 'js-loan-calc-loan-amount'

              - type: 'section'
                resource: :subject_properties
                conditions:
                  - 'construction_application_type'
                options:
                  selector: 'js-construction-loan'
                components:
                  - type: 'text_field'
                    field: :builder_name
                    label: 'Builder Name'
                  - type: 'currency'
                    field: :deposit_amount_with_builder
                    label: 'Deposit Amount with Builder'

              - type: 'section'
                resource: :subject_properties
                conditions:
                  - 'construction_application_type'
                options:
                  selector: 'js-construction-property-use'
                components:
                  - type: "radio_button_collection"
                    label: "How will you be using this property?"
                    field: :property_use
                    options: PROPERTY_USES
                    exclusive: true
                    hints:
                      - value: 2
                        text: "You'll live in the property on a part-time basis and will not generate income from the property when not occupying it."
                      - value: 3
                        text: "You will not live in the property full-time and intend to generate rental income from it."
                    visibility_toggles:
                      selectors:
                        - 'js-occupancy_length'
                      map:
                        - value: 1
                          show:
                            - 'js-occupancy_length'
                  - type: 'checkbox'
                    field: :mixed_use
                    label: 'This will be a mixed use property.'
                    hint: 'Check this box if you will occupy and set aside space within the property to operate your own business.'
                    selector: 'js-construction-mixed_use'
              - type: 'checkbox'
                aria_labelledby: 'property_group_title_1618532474903'
                conditions:
                  - 'pre_approval_or_purchase_application_type'
                field: :prospective_property_mixed_use
                label: 'This is a mixed use property.'
                hint: 'Check this box if you will occupy and set aside space within the property to operate your own business.'
                selector: 'js-prospective_properties_section'
              # Displayed if property_use is primary_residence
              - type: 'section'
                aria_labelledby: 'property_group_title_1618532474903'
                resource: :loan_application
                options:
                  selector: 'js-occupancy_length'
                components:
                  - type: 'select'
                    field: :planned_occupancy_length
                    label: 'Expected Time in House'
                    options: :planned_occupancy_lengths
                    include_blank: 'Please select one'
              - type: 'section'
                aria_labelledby: 'property_group_title_1618532474903'
                resource: :subject_properties
                conditions:
                  - 'purchase_application_type'
                options:
                  selector: 'js-property_contract'
                components:
                  - type: 'radio_button_collection'
                    label: 'Who will be on the title of the property?'
                    field: :title_status
                    options: TITLE_STATUSES
                    visibility_toggles:
                      selectors:
                        - 'js-other_title_owner_purchase'
                        - 'js-title_owners_purchase'
                      map:
                        - value: 3
                          show:
                            - 'js-title_owners_purchase'
                  - type: 'checkbox_collection'
                    label: 'Who else will be on the title?'
                    field: :title_owners
                    options: coapplicants_and_other
                    selector: 'js-title_owners_purchase'
                    visibility_toggles:
                      selectors:
                        - 'js-other_title_owner_purchase'
                      map:
                        - value: "other"
                          show:
                            - 'js-other_title_owner_purchase'
                  - type: 'text_field'
                    field: :other_title_owner
                    label: 'Other title owner'
                    selector: 'js-other_title_owner_purchase'

              - type: 'section'
                resource: :primary_applicant
                conditions:
                  - 'user_is_a_borrower?'
                  - 'account_enabled_hoi'
                options:
                  selector: 'js-property'
                components:
                  - type: 'section'
                    resource: 'hoi_consent'
                    components:
                      - type: component_header
                        text: :hoi_auth_header
                        subtext: 'Homeowners insurance is, and flood insurance may be, required as part of your closing. We have partnered with an independent digital insurance agency to make insurance easy to understand and painless to purchase. By clicking Yes below, you are authorizing us to share your contact information and transaction details with our insurance provider. You are also agreeing to our insurance provider’s <a target="_blank" href="https://itscovered.com/terms-and-conditions">Terms & Conditions</a> and <a target="_blank" href="https://itscovered.com/privacypolicy">Privacy Policy</a>. Please note - use of this service is not required to secure financing. Consult with your lender about the other types of insurance that may be required for your subject property (e.g. flood, wind/hail, etc).'
                      - type: 'button_group'
                        field: :status
                        choices:
                          'Yes': 'granted'
                          'No': 'rejected'
              - type: 'section'
                aria_labelledby: 'property_group_title_1618532474903'
                resource: :subject_properties
                conditions:
                  - 'refinancing_or_home_equity_application_type'
                options:
                  selector: 'js-refi_components_and_heloc'
                components:
                  - type: 'radio_button_collection'
                    label: 'Who will be on the title of the property?'
                    legend_sr_only: 'true'
                    field: :title_status
                    options: TITLE_STATUSES
                    visibility_toggles:
                      selectors:
                        - 'js-other_title_owner_refi'
                        - 'js-title_owners_refi'
                      map:
                        - value: 3
                          show:
                            - 'js-title_owners_refi'
                  - type: 'checkbox_collection'
                    label: 'Who else will be on the title?'
                    field: :title_owners
                    options: coapplicants_and_other
                    selector: 'js-title_owners_refi'
                    visibility_toggles:
                      selectors:
                        - 'js-other_title_owner_refi'
                      map:
                        - value: "other"
                          show:
                            - 'js-other_title_owner_refi'
                  - type: 'text_field'
                    field: :other_title_owner
                    label: 'Other title owner'
                    selector: 'js-other_title_owner_refi'

              # Down payment section. pre-approval/ purchase/ construction
              - type: 'section'
                aria_labelledby: 'property_group_title_1618532474903'
                resource: :loan_application
                conditions:
                  - 'not refinancing_application_type'
                  - 'not home_equity_application_type'
                options:
                  selector: 'js-down-payments-methods'
                components:
                  - type: 'section_title'
                    conditions:
                      - 'purchase_application_type'
                      - 'not pre_approval_application_type'
                    text: 'Loan Declarations'
                    selector: 'js-pre_approval_and_purchase_components'
                  - type: 'radio_button_collection'
                    conditions:
                      - 'not pre_approval_application_type'
                    legend: 'What is the primary source for your down payment?'
                    hint: 'If you have more than one source for your down payment, please select the one that contributes the most.'
                    field: :down_payment_method
                    options: V2_DOWN_PAYMENT_METHODS
                    selector: 'js-down_payment_methods'
                    visibility_toggles:
                      selectors:
                        - 'js-other-down-payment'
                      map:
                        - value: 9
                          show:
                            - 'js-other-down-payment'
                  - type: 'text_field'
                    conditions:
                      - 'not pre_approval_application_type'
                    field: :down_payment_source
                    label: 'Down Payment Source'
                    selector: 'js-other-down-payment mt-3'
                    input_size: 9

              - type: 'section'
                aria_labelledby: 'property_group_title_1618532474903'
                conditions:
                  - 'not refinancing_application_type'
                  - 'not home_equity_application_type'
                options:
                  selector: 'js-down-payment-gifts'
                components:
                  - type: 'section'
                    resource: :loan_application
                    components:
                      - type: 'button_group'
                        field: :receiving_down_payment_gift
                        legend  : 'Are you receiving a gift or grant for your down payment?'
                        hint: 'If you are receiving a gift for your down payment, you will need a gift letter to verify its source, intention, and amount, among other details.'
                        selector: 'js-receiving_down_payment_gift'
                        visibility_toggles:
                          selectors:
                            - 'js-down_payment_gift'
                          map:
                            - value: 'true'
                              show:
                                - 'js-down_payment_gift'
                  - type: 'section'
                    resource: :primary_applicant
                    components:
                      - type: 'recurring_section'
                        add_btn_label: 'Add another gift'
                        resource: :down_payment_gift_assets
                        options:
                          selector: 'js-down_payment_gift'
                        components:
                          - type: 'text_field'
                            field: :donor_organization
                            label: 'Donor Organization'
                            input_size: 9
                          - type: "select"
                            label: 'Source'
                            field: :gift_source
                            input_size: 3
                            options: downpayment_gift_source_options
                            include_blank: 'Please select one'
                          - type: 'text_field'
                            field: :donor_first_name
                            label: 'Donor first name'
                            css_classes: 'col-md-5'
                          - type: 'text_field'
                            field: :donor_last_name
                            label: 'Donor last name'
                            css_classes: 'col-md-5'
                          - type: 'email_field'
                            field: :donor_email_address
                            label: 'Donor email address'
                            input_size: 9
                          # - type: 'component_header'
                          #   text: 'Asset Type'
                          - type: "select"
                            options:
                              'Cash gift': 'gift'
                              'Gift of equity': 'gift_of_equity'
                              'Grant': 'grant'
                            field: :asset_type
                            label: 'Asset Type'
                            input_size: 5
                            include_blank: 'Please select one'
                          - type: 'currency'
                            field: :total
                            label: 'Cash or market value'
                            input_size: 5
                          - type: 'button_group'
                            legend: 'Gift Deposited'
                            field: :deposited
                            choices:
                              'Yes': true
                              'No': false

              # home equity calculator
              - type: 'section'
                legend: 'Home Equity Calculator'
                heading_level: 'h2'
                aria_labelledby: 'property_group_title_1618532474903'
                conditions:
                  - 'home_equity_application_type'
                components:
                  - type: 'section'
                    options:
                      selector: 'js-heloc'
                    components:
                      - type: 'component_header'
                        text: "Let's determine your loan amount"
                        subtext: 'To calculate the amount of your home equity loan, we start with an estimate of the market value of your home. “Loan-To-Value” (LTV) is a percentage arrived at by dividing the value of the home by the amount of the loan. We subtract any existing loans you have, and then end up with an estimate of the maximum amount you could take out for your loan. Let us know your desired loan amount so we can help you get there.'
                  - type: 'section'
                    resource: :subject_properties
                    options:
                      selector: 'js-heloc'
                    components:
                      - type: 'currency'
                        field: :market_value
                        label: 'Estimated Property Value'
                        hint: 'Provide your best guess. We will find an accurate estimate later, after determining an appropriate appraisal method to use.'
                        input_size: 5
                        selector: 'js-market-value'
                        css_classes: 'js-estimated-property-value'
                  - type: 'section'
                    options:
                      selector: 'js-heloc'
                    components:
                      - type: 'pack_v2'
                        allow_empty: true
                        pack_name: 'zillow'
                        full_screen: true
                        account_condition: 'enable_zillow'
                        subtext: 'The full street address, city, state, and zip code is needed in the Property section above to call up Zillow’s estimate. Not all properties have estimates available.'
                  - type: 'section'
                    resource: :subject_properties
                    options:
                      selector: 'js-heloc'
                    components:
                      - type: 'currency'
                        field: :existing_loans
                        label: 'Existing loans on property'
                        hint: 'Enter the outstanding balance of any loan(s) you currently carry on this property, so we can help calculate your loan amount. Additional loan details will be requested in a subsequent section.'
                        selector: 'js-existing-loans'
                        input_size: 5
                  - type: 'section'
                    options:
                      selector: 'js-heloc'
                    components:
                      - type: 'currency'
                        field: :max_equity_with_ltv
                        locked: true
                        selector: 'js-max-equity'
                        label: :max_equity_ltv_label
                        input_size: 5
                      - type: 'currency'
                        field: :maximum_loan_amount
                        locked: true
                        label: 'Estimated Max Loan Amount'
                        input_size: 5
                        selector: 'js-max-loan-amount'
                        css_classes: 'js-estimated-max-loan-amount'
                  - type: 'section'
                    resource: :loan_application
                    options:
                      selector: 'js-heloc'
                    components:
                      - type: 'hidden_field'
                        field: :loan_to_value_ratio
                        selector: 'js-ltv-ratio'
                        disabled: true
                      - type: 'currency'
                        field: :loan_amount
                        label: 'Desired Loan Amount'
                        selector: 'js-loan-amount'
                        input_size: 5
                        css_classes: 'js-desired-loan-amount'

borrower_employment:
  group: "Borrower"
  step_name: "Employment & Income"
  step_identifier: :employment_and_income
  partial: "generic"
  sub_steps:
    - form:
        components:
          - type: 'analytics'
            value: "page_name:pws/application/mortgage/borrower/employment-and-income,page_url:/application/mortgage/borrower/employment-and-income/,funnel_step:borrower,funnel_step_name:employment and income,event_category:nil,event_action:nil,event_content:nil,funnel_name:mortgage application revised urla"
          - type: 'section'
            resource: :primary_applicant
            components:
              - type:  'page_title'
                text: :borrower_employment_and_income_page_title
              - type: 'section_title'
                text: 'Employment'
                id: 'employment_1611193480243'

              - type:  'button_group'
                legend: 'Are you currently employed or have you been employed at some point in the last 2 years?'
                field: :recently_employed
                choices:
                  'Yes': true
                  'No': false
                visibility_toggles:
                  selectors:
                    - 'js-employments'
                  map:
                    - value: 'true'
                      show:
                        - 'js-employments'
              - type: 'section'
                legend: 'Tell us about your jobs from the past two years.'
                options:
                  selector: 'js-employments'
                components:
                  - type: 'recurring_section'
                    add_btn_label: 'Add another position'
                    recurring_section_title:
                      text: 'Tell us about your previous position'
                      #hint:
                      #subtext: ''
                    resource: :employments
                    options:
                      fieldset_legend: 'Employment'
                    components:
                      - type: 'text_field'
                        field: :employer_name
                        label: 'Employer Name'
                      - type: 'phone_field'
                        field: :phone
                        label: 'Employer Phone Number'
                        css_classes: "js-input-phone"
                        input_type: "tel"
                      - type: 'section'
                        resource: :address
                        components:
                          - type: 'address_one_field'
                            field: :address1
                            label: 'Street Address'
                          - type: 'text_field'
                            field: :address2
                            label: 'Apt/Unit/Suite (if applicable)'
                            input_size: 9
                            max_length: 10
                          - type: 'text_field'
                            field: :city
                            label: 'City'
                          - type: 'select'
                            field: :state
                            options: 'state_options'
                            label: 'State'
                            input_size: 3
                            include_blank: 'Please select one'
                            css_classes: 'js-recurring-state-with-county'
                          - type: 'zip_field'
                            field: :zip
                            label: 'Zip'
                            input_size: 3
                          - type: 'select'
                            field: :county_fips
                            label: 'County'
                            options: county_options
                            input_size: 5
                            input_classes: 'js-counties'
                            disabled: 'state_not_present?'
                            css_classes: 'col-md-6'
                          - type: 'select'
                            field: :country
                            options: country_options
                            input_size: 5
                            input_classes: 'js-countries'
                            label: 'Country'
                      - type: 'text_field'
                        field: :position
                        label: 'Position or Title'
                        input_size: 9
                      - type: 'select'
                        field: :industry
                        label: 'Industry'
                        options: 'industries'
                        input_size: 5
                        include_blank: 'Please select one'

                      - type: 'section'
                        options:
                          selector: 'js-date-range'
                        components:
                          - type: 'checkbox'
                            field: :current_employer
                            label: 'I currently work here'
                            visibility_toggles:
                              selectors:
                                - 'js-end-date-emp'
                              map:
                                - value: 'false'
                                  show:
                                    - 'js-end-date-emp'
                          - type: 'date_input'
                            field: :start_date
                            label: 'Start date'
                            selector: 'js-start-date-emp'
                            day_css: 'col-md-2 col-4'
                            month_css: 'col-md-2 col-4'
                            year_css: 'col-md-2 col-4'
                            recurse:
                              date_difference: 63072000
                          - type: 'date_input'
                            field: :end_date
                            label: 'End date'
                            selector: 'js-end-date-emp'
                            day_css: 'col-md-2 col-4'
                            month_css: 'col-md-2 col-4'
                            year_css: 'col-md-2 col-4'
                            error_message: 'End date must be later than start date'
                      - type: 'section'
                        legend: 'Time in line of work'
                        options:
                          selector: 'js-employment-experience'
                        components:
                          - type: 'section'
                            options:
                              selector: 'row'
                            components:
                              - type: 'number_field'
                                field: :years_of_experience
                                label: 'Years'
                                css_classes: 'col-12 col-md-12'
                                selector: 'col-6 col-md-2 js-experience_years'
                                min: 0
                              - type: 'number_field'
                                field: :months_of_experience
                                label: 'Months'
                                css_classes: 'col-12 col-md-12'
                                selector: 'col-6 col-md-2 js-experience_months'
                                min: 0
                                max: 12
                              - type: 'hidden_field'
                                field: :total_experience
                                selector: 'js-total_experience'
                      - type: 'section'
                        conditions:
                          - 'account_enabled_income'
                        options:
                          selector: 'js-employment-income-section js-employment-income-breakdown'
                        components:
                          - type: 'button_group'
                            legend: 'How are you paid?'
                            field: :payment_type
                            choices:
                              'Hourly': 0
                              'Salary': 1
                            visibility_toggles:
                              selectors:
                                - 'js-hourly-rates'
                                - 'js-total-income'
                              map:
                                - value: 0
                                  show:
                                    - 'js-hourly-rates'
                                    - 'js-total-income'
                                - value: 1
                                  show:
                                    - 'js-total-income'
                          - type: 'section'
                            resource: 'income'
                            options:
                              selector: 'js-hourly-rates'
                            components:
                              - type: 'number_field'
                                field: :weekly_hours
                                label: 'Hours per week'
                                aria_label: 'How are you paid?'
                                input_size: 5
                                selector: 'js-weekly_hours'
                                max: 168
                              - type: 'currency'
                                field: :hourly_rate
                                label: 'Hourly rate'
                                aria_label: 'How are you paid?'
                                input_size: 5
                                selector: 'js-hourly_rate'
                          - type: 'section'
                            legend: 'How are you paid?'
                            legend_sr_only: 'true'
                            resource: 'income'
                            options:
                              selector: 'js-total-income'
                            components:
                              - type: 'currency'
                                field: :monthly_income
                                label: 'Base Pay per Month'
                                input_size: 5
                                selector: 'js-monthly_income'
                              - type: 'currency'
                                field: :overtime_per_month
                                label: 'Average Overtime per Month'
                                input_size: 5
                              - type: 'currency'
                                field: :yearly_bonus_income
                                label: 'Total yearly bonuses'
                                input_size: 5
                              - type: 'currency'
                                field: :yearly_commission_income
                                label: 'Total yearly commissions'
                                input_size: 5

                      - type: 'button_group'
                        legend: 'Are you the business owner or self-employed?'
                        hint: 'An individual is an independent contractor if the payer has the right to control or direct the result of the work, but not what will be done and how it will be done.'
                        field: :self_employed
                        visibility_toggles:
                          selectors:
                            - 'js-self-employed'
                          map:
                            - value: 'true'
                              show:
                                - 'js-self-employed'
                      - type: 'section'
                        options:
                          selector: 'js-self-employed'
                        components:
                          - type: 'button_group'
                            legend: 'How much of the business do you own?'
                            field: :ownership_share
                            choices:
                              'Less than 25%': 1
                              '25% or more': 2
                      - type:  'button_group'
                        legend: 'Are you employed by a family member, property seller, real estate agent, or other party to the transaction?'
                        field: :proof_required
                        choices:
                          'Yes': true
                          'No': false
              - type: 'section'
                conditions:
                  - 'account_enabled_income'
                components:
                  - type: 'section'
                    legend: 'Do you receive additional military income?'
                    options:
                      selector: 'js-military-income-question'
                    components:
                      - type: 'hidden_field'
                        field: :military_service
                        selector: 'js-military-income-hidden-field'
                      - type:  'button_group'
                        field: :has_military_income
                        visibility_toggles:
                          selectors:
                            - 'js-military-incomes'
                            - 'js-total-military-income-section'
                          map:
                            - value: 'true'
                              show:
                                - 'js-military-incomes'
                                - 'js-total-military-income-section'
                      - type: 'recurring_section'
                        conditions:
                          - 'account_enabled_specific_military_pay'
                        max_limit: 10
                        add_btn_label: 'Add another military income'
                        resource: 'military_incomes'
                        options:
                          selector: 'js-military-incomes'
                          fieldset_legend: 'Income'
                        components:
                          - type: 'currency'
                            field: :gross_amount
                            selector: 'js-military-gross-amount'
                            label: 'Military Entitlement Pay Type'
                            input_size: 5
                          - type: 'select'
                            field: :source
                            label: 'Entitlement Source'
                            options: 'military_income_sources'
                            include_blank: 'Please select one'
                            input_size: 4
                            visibility_toggles:
                              selectors:
                                - 'js-other_military_source_description'
                              map:
                                - value: 'other'
                                  show:
                                    - 'js-other_military_source_description'
                          - type: 'text_field'
                            label: 'Please specify'
                            field: :source_description
                            input_size: 5
                            selector: 'js-other_military_source_description'
                      - type: 'section'
                        conditions:
                          - 'account_enabled_specific_military_pay'
                        options:
                          selector: 'js-total-military-income-section'
                        components:
                          - type: 'currency'
                            label: 'Total Military Entitlements'
                            field: :total_military_income
                            disabled: true
                            selector: 'js-total-military-income'
                      - type: 'section'
                        resource: 'military_incomes'
                        conditions:
                          - 'not account_enabled_specific_military_pay'
                        options:
                          selector: 'js-military-incomes'
                        components:
                          - type: 'currency'
                            field: :gross_amount
                            label: 'Total Monthly Military Entitlements'
                            aria_label: 'Do you receive any military entitlements?'
                            input_size: 5

                  - type: 'section'
                    legend: 'Other Income'
                    heading_level: 'h2'
                    components:
                    - type: 'section'
                      legend: 'Do you have any other sources of income?'
                      subtext: 'Notice: Alimony, child support, or separate maintenance income need not be revealed if the applicant does not choose to have it considered for repaying this loan.'
                      components:
                        - type:  'button_group'
                          field: :has_other_incomes
                          visibility_toggles:
                            selectors:
                              - 'js-other-incomes'
                            map:
                              - value: 'true'
                                show:
                                  - 'js-other-incomes'
                        - type: 'recurring_section'
                          max_limit: 10
                          add_btn_label: 'Add another income'
                          resource: 'other_incomes'
                          options:
                            selector: 'js-other-incomes'
                            fieldset_legend: 'Income'
                          components:
                            - type: 'currency'
                              field: :gross_amount
                              label: 'Average Monthly income'
                              input_size: 5
                            - type: 'select'
                              field: :source
                              label: 'Source'
                              options: 'other_income_sources'
                              include_blank: 'Please select one'
                              input_size: 4
                              visibility_toggles:
                                selectors:
                                  - 'js-other_source_description'
                                map:
                                  - value: 'other'
                                    show:
                                      - 'js-other_source_description'
                            - type: 'text_field'
                              label: 'Please specify'
                              field: :source_description
                              input_size: 5
                              selector: 'js-other_source_description'

credit:
  group: "Borrower"
  step_name: "Credit"
  step_identifier: :credit
  partial: "generic"
  sub_steps:
    - form:
        components:
          - type: 'section'
            full_screen: true
            renderer: 'liabilities-matching'
            internal_components: 'liability_matching_enabled?'
            components:
              - type: 'section_title'
                text: "Let's talk about your credit"
                css_classes: 'credit_section_heading'
              - type: 'section'
                resource: :primary_applicant
                components:
                  - type: 'section'
                    conditions:
                      - 'enable_ssn'
                    components:
                      - type: "section_title"
                        text: 'Social Security Number'
                        subtext: 'We ask for your social security number in order to pull your Credit / Assets / Income verification report when/if authorized to do so. We take our responsibility to protect your data very seriously. Your application and all personal information are safely stored on highly secure, encrypted servers'
                      - type: 'component_header'
                        text: 'Please enter your Social Security Number.'
                      - type: 'ssn_field'
                        field: :ssn
                        label: 'Social security number'
                        css_classes: 'col-md-2 text-left'
              - type: 'section'
                resource: :primary_coapplicants
                conditions:
                  - 'multi_borrower_enabled'
                  - 'coborrower?'
                  - 'coborrower_is_borrower_spouse'
                  - 'enable_ssn'
                components:
                  - type: 'component_header'
                    text: 'Please enter co-borrower Social Security Number.'
                  - type: 'ssn_field'
                    field: :ssn
                    label: ' Social security number'
                    css_classes: 'col-md-2 text-left'
              - type: 'section'
                resource: 'coapplicants'
                conditions:
                  - 'not multi_borrower_enabled'
                  - 'coborrower?'
                  - 'coborrower_is_borrower_spouse'
                  - 'enable_ssn'
                components:
                  - type: 'component_header'
                    text: 'Please enter co-borrower Social Security Number.'
                  - type: 'ssn_field'
                    field: :ssn
                    label: ' Social security number'
                    css_classes: 'col-md-2 text-left'
              - type: 'section'
                resource: :primary_applicant
                components:
                  - type: 'section'
                    conditions:
                      - 'account_enabled_credit_authorization'
                    components:
                      - type: "section_title"
                        text: 'Credit pull authorization'
                        subtext: "Authorizing your lender to pull your credit right now is not required, but your lender will have to view your credit report eventually because it's important for them to understand what your debt obligations are."
                      - type: 'section'
                        resource: :credit_pull_consent
                        components:
                          - type: 'section'
                            conditions:
                              - 'user_is_a_borrower?'
                            components:
                              - type: 'component_header'
                                text: :credit_pull_auth_text
                              - type: 'button_group'
                                field: :status
                                choices:
                                  'Yes': 'granted'
                                  'No': 'rejected'
                                visibility_toggles:
                                  selectors:
                                    - 'js-estimated_credit'
                                  map:
                                    - value: 'rejected'
                                      show:
                                        - 'js-estimated_credit'
                          - type: 'section'
                            conditions:
                              - 'not user_is_a_borrower?'
                            components:
                              - type: 'component_header'
                                text: :credit_pull_auth_text
                                subtext: :consent_status
                              - type: 'hidden_field'
                                field: :status
                                visibility_toggles:
                                  selectors:
                                    - 'js-estimated_credit'
                                  map:
                                    - value: 'rejected'
                                      show:
                                        - 'js-estimated_credit'
                  - type: "section_title"
                    text: 'Borrower Credit'
                    conditions:
                      - 'not account_enabled_credit_authorization'

                  - type: 'section'
                    options:
                      selector: 'js-estimated_credit'
                    components:
                      - type: 'section'
                        conditions:
                          - 'user_is_a_borrower?'
                        components:
                          - type: 'radio_button_collection'
                            label: 'Estimate your credit'
                            hint: 'We use this information to find the right loan for you.'
                            field: :estimated_credit
                            options: ESTIMATED_CREDIT_SCORE

                      - type: 'section'
                        conditions:
                          - 'not user_is_a_borrower?'
                        components:
                          - type: 'component_header'
                            text: 'Estimate your credit'
                            subtext: :credit_estimation
              - type: 'section'
                conditions:
                  - 'not multi_borrower_enabled'
                  - 'coborrower?'
                  - 'coborrower_is_borrower_spouse'
                resource: 'coapplicants'
                components:
                  - type: 'section'
                    conditions:
                      - 'account_enabled_credit_authorization'
                    components:
                      - type: 'section'
                        components:
                          - type: 'hidden_field'
                            field: :id
                          - type: 'section'
                            resource: :credit_pull_consent
                            components:
                              - type: 'section'
                                conditions:
                                  - 'user_is_a_borrower?'
                                components:
                                  - type: 'component_header'
                                    text: :credit_pull_coborrower_auth_text
                                  - type: 'button_group'
                                    field: :status
                                    choices:
                                      'Yes': 'granted'
                                      'No': 'rejected'
                                    visibility_toggles:
                                      selectors:
                                        - 'js-estimated_credit-coborrower'
                                      map:
                                        - value: 'rejected'
                                          show:
                                            - 'js-estimated_credit-coborrower'
                              - type: 'section'
                                conditions:
                                  - 'not user_is_a_borrower?'
                                components:
                                  - type: 'component_header'
                                    text: :credit_pull_coborrower_auth_text
                                    subtext: :consent_status
                                  - type: 'hidden_field'
                                    field: :status
                                    visibility_toggles:
                                      selectors:
                                        - 'js-estimated_credit-coborrower'
                                      map:
                                        - value: 'rejected'
                                          show:
                                            - 'js-estimated_credit-coborrower'

                  - type: "section_title"
                    text: 'Co-borrower Credit'
                    conditions:
                      - 'not account_enabled_credit_authorization'

                  - type: 'section'
                    options:
                      selector: 'js-estimated_credit-coborrower'
                    components:
                      - type: 'section'
                        conditions:
                          - 'user_is_a_borrower?'
                        components:
                          - type: 'radio_button_collection'
                            label: 'Estimate co-borrower credit'
                            hint: 'We use this information to find the right loan for you.'
                            field: :estimated_credit
                            options: ESTIMATED_CREDIT_SCORE
                      - type: 'section'
                        conditions:
                          - 'not user_is_a_borrower?'
                        components:
                          - type: 'component_header'
                            text: 'Estimate co-borrower credit'
                            subtext: :credit_estimation

              - type: 'section'
                conditions:
                  - 'multi_borrower_enabled'
                  - 'coborrower?'
                  - 'coborrower_is_borrower_spouse'
                resource: :primary_coapplicants
                components:
                  - type: 'section'
                    conditions:
                      - 'account_enabled_credit_authorization'
                    components:
                      - type: 'section'
                        components:
                          - type: 'hidden_field'
                            field: :id
                          - type: 'section'
                            resource: :credit_pull_consent
                            components:
                              - type: 'section'
                                conditions:
                                  - 'user_is_a_borrower?'
                                components:
                                  - type: 'component_header'
                                    text: :credit_pull_coborrower_auth_text
                                  - type: 'button_group'
                                    field: :status
                                    choices:
                                      'Yes': 'granted'
                                      'No': 'rejected'
                                    visibility_toggles:
                                      selectors:
                                        - 'js-estimated_credit-coborrower'
                                      map:
                                        - value: 'rejected'
                                          show:
                                            - 'js-estimated_credit-coborrower'
                              - type: 'section'
                                conditions:
                                  - 'not user_is_a_borrower?'
                                components:
                                  - type: 'component_header'
                                    text: :credit_pull_coborrower_auth_text
                                    subtext: :consent_status
                                  - type: 'hidden_field'
                                    field: :status
                                    visibility_toggles:
                                      selectors:
                                        - 'js-estimated_credit-coborrower'
                                      map:
                                        - value: 'rejected'
                                          show:
                                            - 'js-estimated_credit-coborrower'

                  - type: "section_title"
                    text: 'Co-borrower Credit'
                    conditions:
                      - 'not account_enabled_credit_authorization'

                  - type: 'section'
                    options:
                      selector: 'js-estimated_credit-coborrower'
                    components:
                      - type: 'section'
                        conditions:
                          - 'user_is_a_borrower?'
                        components:
                          - type: 'radio_button_collection'
                            label: 'Estimate co-borrower credit'
                            hint: 'We use this information to find the right loan for you.'
                            field: :estimated_credit
                            options: ESTIMATED_CREDIT_SCORE
                      - type: 'section'
                        conditions:
                          - 'not user_is_a_borrower?'
                        components:
                          - type: 'component_header'
                            text: 'Estimate co-borrower credit'
                            subtext: :credit_estimation

borrower_assets_liabilities:
  group: 'Borrower'
  step_name: "Assets & Liabilities"
  step_identifier: :assets_and_liabilities
  partial: "generic"
  sub_steps:
    - form:
        components:
          - type: 'analytics'
            value: "page_name:pws/application/mortgage/borrower/assets-and-liabilities,page_url:/application/mortgage/borrower/assets-and-liabilities/,funnel_step:borrower,funnel_step_name:assets and liabilities,event_category:nil,event_action:nil,event_content:nil,funnel_name:mortgage application revised urla"
          - type: 'section'
            resource: :primary_applicant
            components:
              - type:  'page_title'
                text: "Let’s get a better picture of your assets & liabilities"
              - type: 'hidden_field'
                field: :is_subject_property_enabled
                disabled: true
                selector: 'js-is_subject_property_enabled'
              - type: 'hidden_field'
                field: :refinance_or_home_equity_type
                disabled: true
                selector: 'js-is-refi-or-heloc'
                visibility_toggles:
                  selectors:
                    - 'js-pre_approval_or_purchase_type'
                    - 'js-refinance_or_home_equity_type_subtitle'
                    - 'js-new-properties-section'
                    - 'js-prospective_section_title'
                    - 'js-is_subject_property'
                    - 'js-prospective_section_title'
                  map:
                    - value: 'true'
                      show:
                        - 'js-refinance_or_home_equity_type_subtitle'
                        - 'js-new-properties-section'
                        - 'js-is_subject_property'

                    - value: 'false'
                      show:
                        - 'js-pre_approval_or_purchase_type'
                        - 'js-prospective_section_title'
              - type: 'section_title'
                text: 'Property'
                selector: 'js-prospective_section_title'
              - type: 'section_title'
                text: 'Subject Property'
                selector: 'js-is_subject_property'
              - type: 'section'
                conditions:
                  - 'not home_equity_application_type'
                options:
                  selector: 'js-pre_approval_or_purchase_type'
                components:
                  - type: 'component_header'
                    text: 'Do you currently have ownership stake in any property?'
                    hint: 'We’ll need to consider any monthly costs (mortgage payments, taxes, insurance, etc.) associated with your other properties when evaluating your debt-to-income ratio.'
                    selector: 'js-pre_approval_or_purchase_type'
                  - type:  'button_group'
                    field: :current_ownership
                    selector: 'js-current-ownership'
                    choices:
                      'Yes': true
                      'No': false
                    visibility_toggles:
                      selectors:
                      - 'js-new-properties-section'
                      map:
                      - value: 'true'
                        show:
                        - 'js-new-properties-section'
              - type: 'section'
                css_classes: 'js-mutex-select-observer'
                options:
                  selector: 'js-new-properties-section'
                components:
                  - type: 'body_paragraph'
                    content: 'Please verify and provide details below for each property you currently own. Add any others that are not currently listed.'
                    hint: "It's alright if you don't know the exact values of the figures requested here. Provide your best estimates. Your loan officer can always revisit this information with you later in the process."
                    selector: 'js-pre_approval_or_purchase_type'
                  - type: 'recurring_section'
                    add_btn_label: 'Add another property'
                    options:
                      selector: 'js-new-property'
                      fieldset_legend: 'Owned property'
                    resource: :new_properties
                    components:
                      - type: 'hidden_field'
                        field: :is_subject_property
                        conditions:
                          - 'refinancing_or_home_equity_application_type'
                        selector: 'js-is_subject_property'
                        visibility_toggles:
                          selectors:
                            - 'js-fields-from-loan'
                            - 'js-subtitle-fields-from-loan'
                          map:
                            - value: 'false'
                              show:
                                - 'js-fields-from-loan'
                            - value: ''
                              show:
                                - 'js-fields-from-loan'
                            - value: 'true'
                              show:
                                - 'js-subtitle-fields-from-loan'
                      - type: 'body_paragraph'
                        conditions:
                        - 'refinancing_or_home_equity_application_type'
                        content: 'Please provide more details for the subject property $street address$'
                        hint: "To change your subject property, go to the Loan section and edit the address."
                        selector: 'js-subtitle-fields-from-loan'
                      - type: 'section'
                        options:
                          selector: 'js-fields-from-loan'
                        components:
                          - type: 'address_one_field'
                            field: :address1
                            label: 'Street Address'
                            input_size: 9
                            selector: 'js-new-property-address-1'
                          - type: 'text_field'
                            field: :address2
                            label: 'Apt/Unit/Suite (if applicable)'
                            input_size: 9
                            max_length: 10
                          - type: 'text_field'
                            field: :city
                            label: 'City'
                            input_size: 9
                          - type: 'select'
                            field: :state
                            options: state_options
                            input_size: 3
                            include_blank: 'Please select one'
                            input_classes: 'js-recurring-state-with-county'
                            label: 'State'
                          - type: 'zip_field'
                            field: :zip
                            label: 'Zip'
                            input_size: 3
                          - type: 'select'
                            field: :county_fips
                            label: 'County'
                            options: county_options
                            input_size: 5
                            input_classes: 'js-counties'
                            disabled: 'state_not_present?'
                            css_classes: 'col-md-6'
                          - type: 'select'
                            field: :country
                            options: country_options
                            input_size: 5
                            input_classes: 'js-countries'
                            label: 'Country'
                          - type: section
                            conditions:
                              - 'coborrower?'
                            components:
                              - type: 'applicant_select_shared'
                                field: :shared_with_coborrowers_tokens
                                label: 'Which co-borrowers also own this property (if any)?'
                                legend: 'Which co-borrowers also own this property (if any)?'
                                legend_sr_only: true
                                single_coapplicant_label: 'Property is owned with the Co-borrower'
                      - type: 'radio_button_collection'
                        label: 'What type of property is it?'
                        field: :property_type
                        options: all_property_types
                        selector: 'js-property_types'
                        hints:
                        - value: 4
                          text: 'A stand-alone structure with its own lot intended for one family.'
                        - value: 5
                          text: 'Multiple separate housing units for residential inhabitants are contained within one building or several buildings within one complex, such as an apartment building or a duplex.'
                        visibility_toggles:
                          selectors:
                          - 'js-number_of_units'
                          map:
                          - value: 5
                            show:
                            - 'js-number_of_units'
                      - type: 'number_field'
                        field: :no_of_units
                        label: 'Number of units'
                        selector: 'js-number_of_units'
                        input_size: 5
                      - type: 'checkbox'
                        label: 'This is a manufactured home'
                        field: :manufactured_home
                        hint: 'A manufactured home is a factory-built dwelling built on a permanent chassis, also known as a mobile home.'
                      - type: 'radio_button_collection'
                        label: 'How are you using this property?'
                        legend: 'How are you using this property?'
                        legend_sr_only: 'true'
                        field: :property_use
                        options: URLA_PROPERTY_USES
                        hints:
                        - value: '2'
                          text: 'You live in the property on a part-time basis and do not generate income from the property when not occupying it.'
                        - value: '3'
                          text: 'You do not live in the property full-time and generate rental income from it.'
                      - type: 'checkbox'
                        field: :mixed_use
                        label: 'This is a mixed use property'
                        hint: 'Check this box if you will occupy and set aside space within the property to operate your own business.'
                      - type: 'radio_button_collection'
                        conditions:
                          - 'not refinancing_or_home_equity_application_type'
                        label: 'What is the current status of the property?'
                        field: :property_status
                        options: PROPERTY_STATUSES
                        visibility_toggles:
                          selectors:
                          - 'js-assets-monthly_rental_income'
                          map:
                          - value: 2
                            show:
                            - 'js-assets-monthly_rental_income'
                      - type: 'component_header'
                        text: 'Property Financials'
                        subtext: "For all the values below, provide the best estimate you can if the question applies to you and enter 0 if it doesn't. Any information you provide below will be corrected to exact values later on in the process."
                      - type: 'currency'
                        field: :market_value
                        selector: 'js-fields-from-loan'
                        label: 'Estimated market value'
                        hint: 'The estimated market value of a home is the price that the property would be expected to sell for on the market.'
                        input_size: 5
                      - type: 'currency'
                        field: :property_value
                        selector: 'js-subtitle-fields-from-loan'
                        label: 'Property Value'
                        hint: 'The estimated property value of a home is the price that the property would be expected to sell for on the market.'
                        input_size: 5
                      - type: 'section'
                        conditions:
                          - 'account_enabled_income'
                        components:
                          - type: "component_header"
                            text: "Any monthly rental income?"
                          - type: 'button_group'
                            field: :rental_income_status
                            selector: 'js-monthly_rental_buttons'
                            visibility_toggles:
                              selectors:
                                - 'js-monthly_rental_income'
                              map:
                                - value: 'true'
                                  show:
                                    - 'js-monthly_rental_income'
                          - type: 'currency'
                            field: :rental_income
                            label: 'Monthly Rental Income'
                            selector: 'js-monthly_rental_income'
                            input_size: 5
                      - type: 'component_header'
                        text: "Does your monthly payment include taxes and insurance in an escrow account?"
                      - type: 'button_group'
                        field: :monthly_payments_escrow
                        selector: 'js-escrow-selector'
                        choices:
                          'Escrow': true
                          'No Escrow': false
                      - type: 'text_field'
                        field: :homeowners_insurance_provider
                        label: "Homeowners insurance provider"
                        input_size: 9
                      - type: 'currency'
                        field: :monthly_homeowners_insurance
                        label: 'Monthly homeowners insurance'
                        input_size: 5
                        selector: 'js-escrow-conditionals'
                      - type: 'currency'
                        field: :monthly_hoa
                        label: 'Monthly HOA Dues'
                        input_size: 5
                      - type: 'currency'
                        field: :annual_tax
                        label: 'Annual property taxes'
                        input_size: 5
                        selector: 'js-escrow-conditionals'
                      - type: 'currency'
                        field: :other_property_related_monthly_payments
                        label: 'Other property-related monthly payments'
                        input_size: 5
                        hint: "Other property-related monthly payments can include Flood Insurance."
                      - type: 'component_header'
                        text: 'Do you have an existing loan on this property?'
                      - type: 'button_group'
                        field: :has_first_existing_mortgage
                        selector: 'js-first-mortgage-question'
                        visibility_toggles:
                          selectors:
                            - 'js-new-properties-first-existing-mortgage'
                          map:
                            - value: 'true'
                              show:
                                - 'js-new-properties-first-existing-mortgage'
                      - type: 'section'
                        resource: :first_existing_mortgage
                        options:
                          selector: 'js-new-properties-first-existing-mortgage'
                        conditions:
                          - 'credit_and_liability_matching_enabled?'
                          - 'applicant_liabilities_present?'
                          - 'applicant_mortgage_liabilities_present?'
                        components:
                          - type: 'select'
                            label: 'Select loan'
                            hint: 'To add loans, please go to the credit section and add any other loans that are not listed.'
                            field: :mortgage_liability
                            options: liability_options
                            css_classes: 'js-mutual_exclusive-mortgage_liability liab_matching'
                            include_blank: 'Please select one'
                            visibility_toggles:
                              selectors:
                                - 'js-first_mortgage_mortgage_liability_data'
                              map:
                                - value: '*'
                                  show:
                                    - 'js-first_mortgage_mortgage_liability_data'
                          - type: 'section'
                            options:
                              selector: 'js-first_mortgage_mortgage_liability_data'
                            components:
                              - type: 'radio_button_collection'
                                label: 'Loan type'
                                field: :mortgage_loan_type
                                options: mortgage_loan_types
                                visibility_toggles:
                                  selectors:
                                    - 'js-first_loan_type_specification'
                                  map:
                                    - value: 5
                                      show:
                                        - 'js-first_loan_type_specification'
                              - type: 'text_field'
                                field: :loan_type_specification
                                label: 'Type of Loan'
                                input_size: 6
                                selector: 'js-first_loan_type_specification'
                              - type: 'percentage_field'
                                field: :mortgage_rate
                                label: 'Interest rate'
                                input_size: 2
                                decimal_places: 3
                              - type: 'currency'
                                field: :monthly_insurance
                                label: 'Monthly mortgage insurance'
                                input_size: 5
                      - type: 'section'
                        resource: :first_existing_mortgage
                        options:
                          selector: 'js-new-properties-first-existing-mortgage'
                        conditions:
                          - 'credit_and_liability_matching_enabled?'
                          - 'applicant_liabilities_present?'
                          - 'not applicant_mortgage_liabilities_present?'
                        components:
                          - type: 'component_header'
                            text: ''
                            subtext: 'You do not have any loans listed. Please go to the credit section and add any other loans that are not listed.'
                      - type: 'section'
                        resource: :first_existing_mortgage
                        options:
                          selector: 'js-new-properties-first-existing-mortgage'
                        conditions:
                          - 'liability_matching_or_liabilities_not_present?'
                        components:
                          - type: 'radio_button_collection'
                            label: 'Kind of loan'
                            field: :kind_of_loan
                            options: :MORTGAGE_KINDS
                            visibility_toggles:
                              selectors:
                                - 'js-monthly_insurance'
                                - 'js-heloc_credit_limit'
                              map:
                                - value: 1
                                  show:
                                    - 'js-monthly_insurance'
                                - value: 3
                                  show:
                                    - 'js-heloc_credit_limit'
                          - type: 'currency'
                            field: :heloc_credit_limit
                            label: 'HELOC Credit Limit'
                            selector: 'js-heloc_credit_limit'
                            input_size: 5
                          - type: 'text_field'
                            field: :lender_name
                            label: 'Lender name'
                            input_size: 6
                          - type: 'text_field'
                            field: :creditor_account_no
                            label: 'Account number'
                            input_size: 6
                            max_length: 50
                            regex_restriction: '[a-zA-Z0-9\-]*'
                          - type: 'currency'
                            field: :monthly_mortgage
                            label: 'Monthly loan payment'
                            input_size: 5
                          - type: 'radio_button_collection'
                            label: 'Loan type'
                            field: :mortgage_loan_type
                            options: mortgage_loan_types
                            visibility_toggles:
                              selectors:
                                - 'js-first_loan_type_specification'
                              map:
                                - value: 5
                                  show:
                                    - 'js-first_loan_type_specification'
                          - type: 'text_field'
                            field: :loan_type_specification
                            label: 'Type of Loan'
                            input_size: 6
                            selector: 'js-first_loan_type_specification'
                          - type: 'percentage_field'
                            field: :mortgage_rate
                            label: 'Interest rate'
                            input_size: 2
                            decimal_places: 3
                          - type: 'currency'
                            field: :mortgage_balance
                            label: 'Balance remaining'
                            input_size: 5
                          - type: 'currency'
                            field: :monthly_insurance
                            label: 'Monthly mortgage insurance'
                            input_size: 5
                            selector: 'js-monthly_insurance'
                          - type: "component_header"
                            text: "Are you paying off this loan with the funds from this request?"
                          - type: 'button_group'
                            field: :loan_with_funds
                          - type: section
                            conditions:
                              - 'coborrower?'
                            components:
                              - type: 'applicant_select_shared'
                                field: :shared_with_coborrowers_tokens
                                label: 'Which co-borrowers also hold this loan (if any)?'
                                legend: 'Which co-borrowers also hold this loan (if any)?'
                                legend_sr_only: true
                                single_coapplicant_label: 'Co-borrower is on the loan'

                      - type: 'component_header'
                        text: 'Do you have another loan on this property?'
                        selector: 'js-second-mortgage-question'
                      - type: 'button_group'
                        field: :has_second_existing_mortgage
                        selector: 'js-second-mortgage-question'
                        visibility_toggles:
                          selectors:
                            - 'js-new-properties-second-existing-mortgage'
                          map:
                            - value: 'true'
                              show:
                                - 'js-new-properties-second-existing-mortgage'
                      - type: 'section'
                        resource: :second_existing_mortgage
                        options:
                          selector: 'js-new-properties-second-existing-mortgage'
                        conditions:
                          - 'credit_and_liability_matching_enabled?'
                          - 'applicant_liabilities_present?'
                          - 'applicant_mortgage_liabilities_present?'
                        components:
                          - type: 'select'
                            label: 'Select loan'
                            hint: 'To add loans, please go to the credit section and add any other loans that are not listed.'
                            field: :mortgage_liability
                            options: liability_options
                            css_classes: 'js-mutual_exclusive-mortgage_liability liab_matching'
                            include_blank: 'Please select one'
                            visibility_toggles:
                              selectors:
                                - 'js-second_mortgage_mortgage_liability_data'
                              map:
                                - value: '*'
                                  show:
                                    - 'js-second_mortgage_mortgage_liability_data'
                          - type: 'section'
                            options:
                              selector: 'js-second_mortgage_mortgage_liability_data'
                            components:
                              - type: 'radio_button_collection'
                                label: 'Loan type'
                                field: :mortgage_loan_type
                                options: mortgage_loan_types
                                visibility_toggles:
                                  selectors:
                                    - 'js-second_loan_type_specification'
                                  map:
                                    - value: 5
                                      show:
                                        - 'js-second_loan_type_specification'
                              - type: 'text_field'
                                field: :loan_type_specification
                                label: 'Type of Loan'
                                input_size: 6
                                error_message: 'Second loan type was not described'
                                selector: 'js-second_loan_type_specification'
                              - type: 'percentage_field'
                                field: :mortgage_rate
                                label: 'Interest rate'
                                input_size: 2
                                decimal_places: 3
                      - type: 'section'
                        resource: :second_existing_mortgage
                        options:
                          selector: 'js-new-properties-second-existing-mortgage'
                        conditions:
                          - 'credit_and_liability_matching_enabled?'
                          - 'applicant_liabilities_present?'
                          - 'not applicant_mortgage_liabilities_present?'
                        components:
                          - type: 'component_header'
                            text: ''
                            subtext: 'You do not have any loans listed. Please go to the credit section and add any other loans that are not listed.'
                      - type: 'section'
                        resource: :second_existing_mortgage
                        options:
                          selector: 'js-new-properties-second-existing-mortgage'
                        conditions:
                          - 'liability_matching_or_liabilities_not_present?'
                        components:
                          - type: 'radio_button_collection'
                            label: 'Kind of loan'
                            field: :kind_of_loan
                            options: second_mortgage_kinds
                            visibility_toggles:
                              selectors:
                                - 'js-second_heloc_credit_limit'
                                - 'js-second-balance-remaining'
                              map:
                                - value: 2
                                  show:
                                    - 'js-second-balance-remaining'
                                - value: 3
                                  show:
                                    - 'js-second_heloc_credit_limit'
                          - type: 'currency'
                            field: :heloc_credit_limit
                            label: 'HELOC Credit Limit'
                            selector: 'js-second_heloc_credit_limit'
                            input_size: 5
                          - type: 'text_field'
                            field: :lender_name
                            label: 'Lender name'
                            input_size: 6
                          - type: 'text_field'
                            field: :creditor_account_no
                            label: 'Account number'
                            input_size: 6
                            max_length: 50
                            regex_restriction: '[a-zA-Z0-9\-]*'
                          - type: 'currency'
                            field: :monthly_mortgage
                            label: 'Monthly loan payment'
                            input_size: 5
                          - type: 'radio_button_collection'
                            label: 'Loan type'
                            field: :mortgage_loan_type
                            options: mortgage_loan_types
                            visibility_toggles:
                              selectors:
                                - 'js-second_loan_type_specification'
                              map:
                                - value: 5
                                  show:
                                    - 'js-second_loan_type_specification'
                          - type: 'text_field'
                            field: :loan_type_specification
                            label: 'Type of Loan'
                            input_size: 6
                            error_message: 'Second loan type was not described'
                            selector: 'js-second_loan_type_specification'
                          - type: 'percentage_field'
                            field: :mortgage_rate
                            label: 'Interest rate'
                            input_size: 2
                            decimal_places: 3
                          - type: 'currency'
                            field: :mortgage_balance
                            label: 'Balance remaining'
                            selector: 'js-second-balance-remaining'
                            input_size: 5
                          - type: 'component_header'
                            text: "Are you paying off this loan with the funds from this request?"
                          - type: 'button_group'
                            field: :loan_with_funds
                          - type: section
                            conditions:
                              - 'coborrower?'
                            components:
                              - type: 'applicant_select_shared'
                                field: :shared_with_coborrowers_tokens
                                label: 'Which co-borrowers also hold this loan (if any)?'
                                legend: 'Which co-borrowers also hold this loan (if any)?'
                                legend_sr_only: true
                                single_coapplicant_label: 'Co-borrower is on the loan'

              - type: 'section'
                conditions:
                  - 'primary_use_property?'
                components:
                  - type: 'component_header'
                    text: "Are there any other properties that you don't currently own, but did own in the last three years?"
                    subtext: 'This includes both property you owned yourself, and any property you co-owned with others.'
                  - type: 'button_group'
                    field: :recent_ownership
                    choices:
                      'Yes': true
                      'No': false
                    visibility_toggles:
                      selectors:
                        - 'js-owned_property_use'
                        - 'js-own_property_title'
                      map:
                        - value: 'true'
                          show:
                            - 'js-owned_property_use'
                            - 'js-own_property_title'
                  - type: 'radio_button_collection'
                    label: 'How did you use the property that you owned?'
                    field: :owned_property_use
                    selector: 'js-owned_property_use'
                    options: URLA_PROPERTY_USES_EXCEPT_OTHER
                    hints:
                      - value: '2'
                        text: 'You live in the property on a part-time basis and do not generate income from the property when not occupying it.'
                      - value: '3'
                        text: 'You do not live in the property full-time and generate rental income from it.'
                  - type: 'radio_button_collection'
                    label: 'How did you own the title?'
                    field: :owned_property_title
                    options: OWNED_TITLE_TYPES
                    selector: 'js-own_property_title'

          - type: 'section'
            resource: :primary_applicant
            conditions:
              - "account_enabled_assets"
            components:
              - type: "section_title"
                text: 'Financial assets'
              - type: 'section'
                conditions:
                  - 'user_is_a_borrower?'
                components:
                  - type: 'financial_assets_declaration'
                  - type: 'component_header'
                    text: 'Would you like to connect your bank account to prefill financial information?'
                    conditions:
                      - "asset_verification_app_enabled?"
                  - type:  'button_group'
                    field: :manually_setup_assets
                    conditions:
                      - "asset_verification_app_enabled?"
                    choices:
                      'Yes': true
                      'No': false
                    visibility_toggles:
                      selectors:
                        - 'js-voa-assets'
                      map:
                        - value: 'true'
                          show:
                            - 'js-voa-assets'

                  - type: 'section'
                    conditions:
                      - "asset_verification_app_enabled?"
                    options:
                      selector: 'js-voa-assets'
                    components:
                      - type: "analytics"
                        value: "page_name:pws/application/mortgage/assestsandliabilities/accountchekassets,page_url:/application/mortgage/assests-and-liabilities/accountchek-assets/,funnel_step:assestsandliabilities,funnel_step_name:accountchek assests,event_category:nil,event_action:nil,event_content:nil"
                      - type: "voa_generator_v2"

              - type: 'recurring_section'
                max_limit: 30
                add_btn_label: 'Add another asset'
                options:
                  fieldset_legend: 'Asset'
                resource: :assets
                components:
                  - type: 'text_field'
                    field: :financial_institution
                    label: 'Institution / Asset Name'
                    input_size: 9
                  - type: "select"
                    options: :asset_type_options
                    field: :asset_type
                    label: 'Asset Type'
                    input_size: 5
                    include_blank: 'Please select one'
                  - type: 'currency'
                    field: :total
                    label: 'Estimated current balance'
                    input_size: 5
                    css_classes: 'js-no-decimal-input-allow-negative'
                    hint: 'If you don’t know the exact amount in each account, we can make any necessary edits once you provide your current bank statements.'
                    error_message: 'Estimated current balance for financial assets is required'

                  - type: section
                    conditions:
                      - 'coborrower?'
                    components:
                      - type: 'applicant_select_shared'
                        field: :shared_with_coborrowers_tokens
                        label: 'Which co-borrowers also hold this account (if any)?'
                        legend: 'Which co-borrowers also hold this account (if any)?'
                        legend_sr_only: true
                        single_coapplicant_label: 'This account is jointly owned with the Co-borrower.'

          - type: 'section'
            resource: :primary_applicant
            components:
              - type: 'section_title'
                text: 'Ongoing payments'
              - type: 'checkbox_collection'
                legend: 'Do you make any of the following ongoing payments?'
                field: :ongoing_payments
                options: ONGOING_PAYMENT_TYPES
                css_classes: 'mb-3'
                visibility_toggles:
                  selectors:
                    - 'js-alimony-or-spousal-support-payment'
                    - 'js-child-support-payment'
                    - 'js-other-payment'
                    - 'js-separate-maintenance-payment'
                    - 'js-job-related-expenses-payment'
                  map:
                    - value: 1
                      show:
                        - 'js-alimony-or-spousal-support-payment'
                    - value: 2
                      show:
                        - 'js-child-support-payment'
                    - value: 3
                      show:
                        - 'js-other-payment'
                    - value: 4
                      show:
                        - 'js-separate-maintenance-payment'
                    - value: 5
                      show:
                        - 'js-job-related-expenses-payment'
              - type: 'currency'
                field: :alimony_amount
                label: 'Monthly Alimony Support Payment'
                input_size: 5
                selector: 'js-alimony-or-spousal-support-payment'
              - type: 'currency'
                selector: 'js-child-support-payment'
                field: :child_support_amount
                label: 'Monthly Child Support Payment'
                input_size: 5
              - type: 'currency'
                selector: 'js-separate-maintenance-payment'
                field: :separate_maintenance_amount
                label: 'Monthly Separate Maintenance Payment'
                input_size: 5
              - type: 'currency'
                selector: 'js-job-related-expenses-payment'
                field: :job_related_expenses_amount
                label: 'Monthly Job Related Expenses Payment'
                input_size: 5
              - type: 'text_field'
                selector: 'js-other-payment'
                field: :other_support_type
                label: 'Other Monthly Payment Category'
                input_size: 9
              - type: 'currency'
                selector: 'js-other-payment'
                field: :other_support_amount
                label: 'Other Monthly Support Payment'
                input_size: 5

borrower_declarations:
  group: "Borrower"
  step_name: "Declarations"
  step_identifier: :declarations
  partial: "generic"
  sub_steps:
    - form:
        components:
          - type: 'analytics'
            value: "page_name:pws/application/mortgage/borrower/declarations,page_url:/application/mortgage/borrower/declarations/,funnel_step:borrower,funnel_step_name:declarations,event_category:nil,event_action:nil,event_content:nil,funnel_name:mortgage application revised urla"
          - type: 'page_title'
            text: 'Declarations: This section asks you specific questions about the property, your funding, and your past financial history.'
          - type: 'section_title'
            text: 'About this Property and Your Money for this Loan.'
          - type: 'section'
            resource: 'primary_applicant'
            components:
              - type: 'declaration'
                label: "Will you occupy the property as your primary residence?"
                field: :occupy_property_as_primary_residence
                css_classes: 'js-occupy_property_as_primary_residence'
                condition_interpolation: '%{ loan_application&.residential_loan&.subject_property&.property_use }'
                error_message: 'Review the application response for property use, as it conflicts with the declaration response.'
                visibility_toggles:
                  selectors:
                    - 'js-previous_ownership_interest'
                    - 'js-owned_property_type'
                    - 'js-owned_property_title'
                  map:
                    - value: 'true'
                      show:
                        - 'js-previous_ownership_interest'
              - type: 'declaration'
                selector: 'js-previous_ownership_interest'
                field: :recent_ownership
                label: "Have you had ownership interest in another property in the last three years?"
                visibility_toggles:
                  selectors:
                    - 'js-owned_property_type'
                    - 'js-owned_property_title'
                  map:
                    - value: 'true'
                      show:
                        - 'js-owned_property_type'
                        - 'js-owned_property_title'
              - type: 'select'
                selector: 'js-owned_property_type'
                label: "What type of property did you own?"
                field: :owned_property_use
                options: URLA_DECLARATIONS_PROPERTY_USES
                include_blank: true
              - type: 'select'
                selector: 'js-owned_property_title'
                label: "How did you hold title to the property?"
                field: :owned_property_title
                options: OWNED_TITLE_TYPES_EXCEPT_TRUST
                include_blank: true
              - type: 'declaration'
                label: "If this is a Purchase Transaction: Do you have a family relationship or business affiliation with the seller of the property?"
                field: :has_relationship_with_seller
              - type: 'section'
                components:
                  - type: 'declaration'
                    field: :has_undisclosed_finances
                    label: 'Are you borrowing or obtaining any money for this real estate transaction (e.g. money for your closing costs or down payment) or obtaining any money from another party, such as the seller or retailer, that you have not disclosed on this loan application?'
                    selector: 'js-has_undisclosed_finances'
                    visibility_toggles:
                      selectors:
                        - 'js-undisclosed_dollar_amount'
                      map:
                        - value: 'true'
                          show:
                            - 'js-undisclosed_dollar_amount'
                  - type: 'currency'
                    field: :undisclosed_dollar_amount
                    label: 'Amount'
                    selector: 'js-undisclosed_dollar_amount'
                    input_size: 5
              - type:  'declaration'
                field: :other_property_other_mortgage
                label: 'Have you or will you be applying for a mortgage loan on another property (not the property securing this loan) on or before closing of this transaction that is not disclosed on this loan application?'
              - type:  'declaration'
                field: :new_credit
                label: 'Have you or will you be applying for any new credit (e.g. installment loan, credit card, etc.) on or before closing of this loan that is not disclosed on this application?'
              - type:  'declaration'
                field: :priority_lien
                label: 'Will this property be subject to a lien that could take priority over the first mortgage lien, such as a clean energy lien paid through your property taxes (e.g. the Property Assessed Clean Energy Program)?'

              - type: 'section_title'
                text: 'About Your Finances'
              - type:  'declaration'
                field: :cosigner_of_undisclosed
                label: 'Are you a co-signer or guarantor on any debt or loan that is not disclosed on this application?'
              - type: 'declaration'
                field: :has_judgements
                label: 'Are there any outstanding judgments against you?'

              - type:  'declaration'
                field: :delinquency
                label: 'Are you currently delinquent or in default on a Federal debt?'

              - type:  'declaration'
                field: :has_lawsuit
                label: 'Are you a party to a lawsuit in which you potentially have any personal financial liability?'

              - type:  'declaration'
                field: :has_loan_foreclosure
                label: 'Have you conveyed title to any property in lieu of foreclosure in the past 7 years?'

              - type:  'declaration'
                field: :pre_foreclosure
                label: 'Within the past 7 years, have you completed a pre-foreclosure sale or short sale, whereby the property was sold to a third party and the Lender agreed to accept less than the outstanding mortgage balance due?'

              - type:  'declaration'
                field: :has_property_foreclosure
                label: 'Have you had property foreclosed upon in the last 7 years?'

              - type:  'declaration'
                field: :has_bankruptcy
                label: 'Have you declared bankruptcy within the past 7 years?'
                choices:
                  'No': false
                  'Yes': true
                visibility_toggles:
                  selectors:
                    - 'js-bankruptcies'
                  map:
                    - value: 'true'
                      show:
                        - 'js-bankruptcies'
              - type: 'recurring_section'
                add_btn_label: 'Add bankruptcy'
                resource: 'bankruptcies'
                max_limit: 4
                options:
                  selector: 'js-bankruptcies'
                  fieldset_legend: 'Bankruptcy'
                components:
                  - type: 'select'
                    label: 'Type of bankruptcy'
                    field: :type
                    options: types
                    input_size: 4
                    include_blank: 'Please select one'
              - type: 'section'
                conditions:
                  - 'enable_2018_hmda'
                  - 'not pre_approval_application_type'
                components:
                  - type: 'section_divider'
                  - type: 'section_title'
                    text: 'Demographic questions'
                  - type: 'component_header'
                    text: 'Disclaimer'
                    subtext: 'The purpose of collecting this information is to help ensure that all applicants are treated fairly and that the housing needs of communities and neighborhoods are being fulfilled. For residential mortgage lending, Federal law requires that we ask applicants for their demographic information (ethnicity, sex, and race) in order to monitor our compliance with equal credit opportunity, fair housing, and home mortgage disclosure laws. You are not required to provide this information, but are encouraged to do so. You may select one or more designations for "Ethnicity" and one or more designations for "Race". The law provides that we may not discriminate on the basis of this information, or on whether you choose to provide it. However, if you choose not to provide the information and you have made this application in person, Federal regulations require us to note your ethnicity, sex, and race on the basis of visual observation or surname. The law also provides that we may not discriminate on the basis of age or marital status information you provide in this application. If you do not wish to provide some or all of this information, please check below.'
                  - type: 'hidden_field'
                    field: :account_enable_2018_hmda_select_all
                    disabled: true
                    selector: 'js-account-hmda-select-all'

                  - type: 'radio_button_collection'
                    conditions:
                      - 'account_enabled_hmda_demograph_info'
                    field: :hmda_demographic_information_provided_through
                    legend: 'Demographic Information provided through:'
                    options: DEMOGRAPHIC_INFORMATION_PROVIDED_THROUGH
                    selector: 'js-hmda-demograph-info'

                  - type: 'section'
                    options:
                      selector: 'js-declarations'
                    components:
                      - type: 'section'
                        legend: 'Please provide information about your ethnicity.'
                        css_classes: 'js-required-section'
                        error_message: 'At least one ethnicity selection must be made.'
                        required: true
                        unordered_list: 'true'
                        components:
                          - type: 'checkbox'
                            label: 'Not Hispanic or Latino'
                            field: :hmda_not_hispanic_or_latino
                            css_classes: 'js-hmda'
                          - type: 'checkbox'
                            label: 'Hispanic or Latino'
                            field: :hmda_hispanic_or_latino
                            css_classes: 'js-hmda'
                            components:
                              - type: 'checkbox'
                                label: 'Mexican'
                                field: :hmda_mexican
                                css_classes: 'js-hmda'
                              - type: 'checkbox'
                                label: 'Puerto Rican'
                                field: :hmda_puerto_rican
                                css_classes: 'js-hmda'
                              - type: 'checkbox'
                                label: 'Cuban'
                                field: :hmda_cuban
                                css_classes: 'js-hmda'
                              - type: 'checkbox'
                                label: 'Other Hispanic or Latino'
                                field: :hmda_other_hispanic_or_latino
                                css_classes: 'js-hmda'

                              # Nested Child Text Input
                              - type: 'text_field'
                                label: 'Enter Origin'
                                field: :hmda_hispanic_or_latino_description
                                css_classes: 'js-input-hmda_hispanic_or_latino_description js-hmda'
                                input_size: 9
                                indent: 'small'
                                supporting_text: 'Examples: Argentinean, Salvadoran, Spaniard, etc.'
                          - type: 'checkbox'
                            label: 'I do not wish to provide this information'
                            pdf_label: 'Ethnicity: I do not wish to provide this information'
                            field: :hmda_provides_ethnicity
                            reverse: true
                            selector: 'js-provides_ethnicity'
                            css_classes: 'js-hmda'

                  - type: 'section_border'

                  - type: 'section'
                    options:
                      selector: 'js-declarations'
                    components:
                      - type: 'section'
                        legend: 'Please provide information about your race.'
                        css_classes: 'js-required-section'
                        error_message: 'At least one race selection must be made.'
                        required: true
                        unordered_list: true
                        components:
                          - type: 'checkbox'
                            label: 'American Indian or Alaska Native'
                            field: :hmda_american_indian_or_alaskan
                            css_classes: 'js-hmda'
                            visibility_toggles:
                              selectors:
                                - 'js-hmda_american_indian_or_alaskan_description'
                              map:
                                - value: 'true'
                                  show:
                                    - 'js-hmda_american_indian_or_alaskan_description'
                            checkboxes_toggles:
                              values:
                                - value: true
                                  toggles:
                                    - map:
                                      - value: ''
                                        attribute: 'value'
                                        selector:
                                          - 'js-input-hmda_american_indian_or_alaskan_description'
                          # Child Text Input
                          - type: 'text_field'
                            label: 'Enrolled or principal tribe name'
                            field: :hmda_american_indian_or_alaskan_description
                            selector: 'js-hmda_american_indian_or_alaskan_description'
                            css_classes: 'js-input-hmda_american_indian_or_alaskan_description js-hmda-race'
                            input_size: 9
                            indent: 'small'
                            required_conditions:
                              fields:
                                - field: :hmda_american_indian_or_alaskan
                                  value: 'true'

                          - type: 'checkbox'
                            label: 'Asian'
                            css_classes: 'js-hmda'
                            field: :hmda_asian
                            components:
                              - type: 'checkbox'
                                label: 'Asian Indian'
                                field: :hmda_asian_indian
                                css_classes: 'js-hmda'
                              - type: 'checkbox'
                                label: 'Chinese'
                                field: :hmda_chinese
                                css_classes: 'js-hmda'
                              - type: 'checkbox'
                                label: 'Filipino'
                                field: :hmda_filipino
                                css_classes: 'js-hmda'
                              - type: 'checkbox'
                                label: 'Japanese'
                                field: :hmda_japanese
                                css_classes: 'js-hmda'
                              - type: 'checkbox'
                                label: 'Korean'
                                field: :hmda_korean
                                css_classes: 'js-hmda'
                              - type: 'checkbox'
                                label: 'Vietnamese'
                                field: :hmda_vietnamese
                                css_classes: 'js-hmda'
                              - type: 'checkbox'
                                label: 'Other Asian'
                                field: :hmda_other_asian
                                css_classes: 'js-hmda'
                              # Nested Child Text Input
                              - type: 'text_field'
                                label: 'Race'
                                field: :hmda_other_asian_description
                                css_classes: 'js-input-hmda_other_asian_description js-hmda-race'
                                input_size: 9
                                indent: 'small'
                                supporting_text: 'Examples: Hmong, Laotian, Thai, Pakistani, Cambodian, etc.'
                                required_conditions:
                                  fields:
                                    - field: :hmda_other_asian
                                      value: 'true'

                          - type: 'checkbox'
                            label: 'Black or African American'
                            field: :hmda_black_or_african_american
                            css_classes: 'js-hmda'

                          - type: 'checkbox'
                            label: 'Native Hawaiian or other Pacific Islander'
                            field: :hmda_hawaiian_or_other_pacific_islander
                            css_classes: 'js-hmda'
                            components:
                              # Nested
                              - type: 'checkbox'
                                label: 'Native Hawaiian'
                                field: :hmda_native_hawaiian
                                css_classes: 'js-hmda'
                              - type: 'checkbox'
                                label: 'Guamanian or Chamorro'
                                field: :hmda_guamanian_or_chamorro
                                css_classes: 'js-hmda'
                              - type: 'checkbox'
                                label: 'Samoan'
                                field: :hmda_samoan
                                css_classes: 'js-hmda'
                              - type: 'checkbox'
                                label: 'Other Pacific Islander'
                                field: :hmda_other_pacific_islander
                                css_classes: 'js-hmda'

                              # Nested Child Text Input
                              - type: 'text_field'
                                label: 'Race'
                                field: :hmda_other_pacific_islander_description
                                css_classes: 'js-input-hmda_other_pacific_islander_description js-hmda-race'
                                input_size: 9
                                indent: 'small'
                                supporting_text: 'Examples: Fijian, Tongan, etc.'
                                required_conditions:
                                  fields:
                                    - field: :hmda_other_pacific_islander
                                      value: 'true'

                          - type: 'checkbox'
                            label: 'White'
                            field: :hmda_white
                            css_classes: 'js-hmda'
                          - type: 'checkbox'
                            label: 'I do not wish to provide this information'
                            pdf_label: 'Race: I do not wish to provide this information'
                            field: :hmda_provides_race
                            css_classes: 'js-hmda'
                            reverse: true
                            selector: 'js-provides_race'

                  - type: 'section_border'

                  - type: 'section'
                    options:
                      selector: 'js-declarations'
                    components:
                      - type: 'section'
                        legend: 'Please provide information about your sex.'
                        css_classes: 'js-required-section'
                        error_message: 'At least one selection must be made.'
                        required: true
                        unordered_list: true
                        components:
                          - type: 'checkbox'
                            label: 'Female'
                            field: :hmda_female
                            css_classes: 'js-hmda'
                          - type: 'checkbox'
                            label: 'Male'
                            field: :hmda_male
                            css_classes: 'js-hmda'
                          - type: 'checkbox'
                            label: 'I do not wish to provide this information'
                            pdf_label: 'Gender: I do not wish to provide this information'
                            field: :hmda_provides_gender
                            css_classes: 'js-hmda'
                            reverse: true
                            selector: 'js-provides_gender'


release:
  step_name: 'Application Release'
  step_identifier: :application_release
  partial: 'generic'
  sub_steps:
    - form:
        components:
          - type: 'analytics'
            value: "page_name:pws/application/mortgage/borrower/application-release,page_url:/application/mortgage/borrower/application-release/,funnel_step:borrower,funnel_step_name:application release,event_category:nil,event_action:nil,event_content:nil,funnel_name:mortgage application revised urla"
          - type: 'section'
            resource: :primary_applicant
            conditions:
              - 'not credit_section_enabled'
              - 'enable_ssn'
            components:
              - type: "section_title"
                text: 'Social Security Number'
                subtext: 'We ask for your social security number in order to pull your Credit / Assets / Income verification report when/if authorized to do so. We take our responsibility to protect your data very seriously. Your application and all personal information are safely stored on highly secure, encrypted servers'
              - type: 'section'
                components:
                  - type: 'component_header'
                    text: 'Please enter your Social Security Number.'
                  - type: 'ssn_field'
                    field: :ssn
                    label: ' Social security number'
                    css_classes: 'col-md-2 text-left'
          - type: 'section'
            resource: :primary_coapplicants
            conditions:
              - 'multi_borrower_enabled'
              - 'coborrower?'
              - 'coborrower_is_borrower_spouse'
              - 'not credit_section_enabled'
              - 'enable_ssn'
            components:
              - type: 'section'
                components:
                  - type: 'component_header'
                    text: 'Please enter co-borrower Social Security Number.'
                  - type: 'ssn_field'
                    field: :ssn
                    label: ' Social security number'
                    css_classes: 'col-md-2 text-left'
          - type: 'section'
            resource: 'coapplicants'
            conditions:
              - 'not multi_borrower_enabled'
              - 'coborrower?'
              - 'coborrower_is_borrower_spouse'
              - 'not credit_section_enabled'
              - 'enable_ssn'
            components:
              - type: 'section'
                components:
                  - type: 'component_header'
                    text: 'Please enter co-borrower Social Security Number.'
                  - type: 'ssn_field'
                    field: :ssn
                    label: ' Social security number'
                    css_classes: 'col-md-2 text-left'
          - type: 'section'
            resource: :primary_applicant
            conditions:
              - 'not credit_section_enabled'
            components:
              - type: 'section'
                conditions:
                  - 'account_enabled_credit_authorization'
                components:
                  - type: "section_title"
                    text: 'Credit pull authorization'
                    subtext: "Authorizing your lender to pull your credit right now is not required, but your lender will have to view your credit report eventually because it's important for them to understand what your debt obligations are."
                  - type: 'section'
                    resource: :credit_pull_consent
                    components:
                      - type: 'section'
                        conditions:
                          - 'user_is_a_borrower?'
                        components:
                          - type: 'component_header'
                            text: :credit_pull_auth_text
                          - type: 'button_group'
                            field: :status
                            choices:
                              'Yes': 'granted'
                              'No': 'rejected'
                            visibility_toggles:
                              selectors:
                                - 'js-estimated_credit'
                              map:
                                - value: 'rejected'
                                  show:
                                    - 'js-estimated_credit'
                      - type: 'section'
                        conditions:
                          - 'not user_is_a_borrower?'
                        components:
                          - type: 'component_header'
                            text: :credit_pull_auth_text
                            subtext: :consent_status
                          - type: 'hidden_field'
                            field: :status
                            visibility_toggles:
                              selectors:
                                - 'js-estimated_credit'
                              map:
                                - value: 'rejected'
                                  show:
                                    - 'js-estimated_credit'
              - type: "section_title"
                text: 'Borrower Credit'
                conditions:
                  - 'not account_enabled_credit_authorization'

              - type: 'section'
                options:
                  selector: 'js-estimated_credit'
                components:
                  - type: 'section'
                    conditions:
                      - 'user_is_a_borrower?'
                    components:
                      - type: 'radio_button_collection'
                        label: 'Estimate your credit'
                        hint: 'We use this information to find the right loan for you.'
                        field: :estimated_credit
                        options: ESTIMATED_CREDIT_SCORE

                  - type: 'section'
                    conditions:
                      - 'not user_is_a_borrower?'
                    components:
                      - type: 'component_header'
                        text: 'Estimate your credit'
                        subtext: :credit_estimation

          - type: 'section'
            conditions:
              - 'not multi_borrower_enabled'
              - 'coborrower?'
              - 'coborrower_is_borrower_spouse'
              - 'not credit_section_enabled'
            resource: 'coapplicants'
            components:
              - type: 'section'
                conditions:
                  - 'account_enabled_credit_authorization'
                components:
                  - type: 'section'
                    components:
                      - type: "section_title"
                        text: 'Co-borrower credit pull authorization'
                        subtext: "Authorizing your lender to pull co-borrower credit right now is not required, but your lender will have to view co-borrower credit report eventually because it's important for them to understand what your debt obligations are."
                      - type: 'hidden_field'
                        field: :id
                      - type: 'section'
                        resource: :credit_pull_consent
                        components:
                          - type: 'section'
                            conditions:
                              - 'user_is_a_borrower?'
                            components:
                              - type: 'component_header'
                                text: :credit_pull_coborrower_auth_text
                              - type: 'button_group'
                                field: :status
                                choices:
                                  'Yes': 'granted'
                                  'No': 'rejected'
                                visibility_toggles:
                                  selectors:
                                    - 'js-estimated_credit-coborrower'
                                  map:
                                    - value: 'rejected'
                                      show:
                                        - 'js-estimated_credit-coborrower'
                          - type: 'section'
                            conditions:
                              - 'not user_is_a_borrower?'
                            components:
                              - type: 'component_header'
                                text: :credit_pull_coborrower_auth_text
                                subtext: :consent_status
                              - type: 'hidden_field'
                                field: :status
                                visibility_toggles:
                                  selectors:
                                    - 'js-estimated_credit-coborrower'
                                  map:
                                    - value: 'rejected'
                                      show:
                                        - 'js-estimated_credit-coborrower'

              - type: "section_title"
                text: 'Co-borrower Credit'
                conditions:
                  - 'not account_enabled_credit_authorization'

              - type: 'section'
                options:
                  selector: 'js-estimated_credit-coborrower'
                components:
                  - type: 'section'
                    conditions:
                      - 'user_is_a_borrower?'
                    components:
                      - type: 'radio_button_collection'
                        label: 'Estimate co-borrower credit'
                        hint: 'We use this information to find the right loan for you.'
                        field: :estimated_credit
                        options: ESTIMATED_CREDIT_SCORE
                  - type: 'section'
                    conditions:
                      - 'not user_is_a_borrower?'
                    components:
                      - type: 'component_header'
                        text: 'Estimate co-borrower credit'
                        subtext: :credit_estimation
          - type: 'section'
            conditions:
              - 'multi_borrower_enabled'
              - 'coborrower?'
              - 'coborrower_is_borrower_spouse'
              - 'not credit_section_enabled'
            resource: :primary_coapplicants
            components:
              - type: 'section'
                conditions:
                  - 'account_enabled_credit_authorization'
                components:
                  - type: 'section'
                    components:
                      - type: "section_title"
                        text: 'Co-borrower credit pull authorization'
                        subtext: "Authorizing your lender to pull co-borrower credit right now is not required, but your lender will have to view co-borrower credit report eventually because it's important for them to understand what your debt obligations are."
                      - type: 'hidden_field'
                        field: :id
                      - type: 'section'
                        resource: :credit_pull_consent
                        components:
                          - type: 'section'
                            conditions:
                              - 'user_is_a_borrower?'
                            components:
                              - type: 'component_header'
                                text: :credit_pull_coborrower_auth_text
                              - type: 'button_group'
                                field: :status
                                choices:
                                  'Yes': 'granted'
                                  'No': 'rejected'
                                visibility_toggles:
                                  selectors:
                                    - 'js-estimated_credit-coborrower'
                                  map:
                                    - value: 'rejected'
                                      show:
                                        - 'js-estimated_credit-coborrower'
                          - type: 'section'
                            conditions:
                              - 'not user_is_a_borrower?'
                            components:
                              - type: 'component_header'
                                text: :credit_pull_coborrower_auth_text
                                subtext: :consent_status
                              - type: 'hidden_field'
                                field: :status
                                visibility_toggles:
                                  selectors:
                                    - 'js-estimated_credit-coborrower'
                                  map:
                                    - value: 'rejected'
                                      show:
                                        - 'js-estimated_credit-coborrower'

              - type: "section_title"
                text: 'Co-borrower Credit'
                conditions:
                  - 'not account_enabled_credit_authorization'

              - type: 'section'
                options:
                  selector: 'js-estimated_credit-coborrower'
                components:
                  - type: 'section'
                    conditions:
                      - 'user_is_a_borrower?'
                    components:
                      - type: 'radio_button_collection'
                        label: 'Estimate co-borrower credit'
                        hint: 'We use this information to find the right loan for you.'
                        field: :estimated_credit
                        options: ESTIMATED_CREDIT_SCORE
                  - type: 'section'
                    conditions:
                      - 'not user_is_a_borrower?'
                    components:
                      - type: 'component_header'
                        text: 'Estimate co-borrower credit'
                        subtext: :credit_estimation
